#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Wed Oct 17 13:46:00 2018

This file explores the LCF original survey data from the UKDA

@author: earao
"""

import numpy as np
import pandas as pd
import io_functions as io
import os
df = pd.DataFrame

def makestrings(hhspenddata,oac_2001_years,oac_2011_years):
    
    for yr in oac_2001_years:
        for i in hhspenddata[yr].index:
            hhspenddata[yr].loc[i,'OA class 1D'] = str(hhspenddata[yr].loc[i,'OA class 1D'])
        
    for yr in oac_2011_years:
        for i in hhspenddata[yr].index:
            hhspenddata[yr].loc[i,'OA class 1D'] = str(hhspenddata[yr].loc[i,'OA class 1D'])
            
    return hhspenddata


def makeoacspends(hhspenddata,oac_none_years,oac_2001_years,oac_2011_years):
    
    oacyrspends = {}
    oacyrmeta = {}
    
    regions = ['North East','North West','Yorkshire and The Humber','East Midlands','West Midlands','East','London','South East','South West']


    for yr in oac_2001_years:
        
        regspends = {}
        regmeta = {}
            
        for reg in range(1,10):
            
            if yr == 2008:
                lookup2001 = df({'oac3':['1a1','1a2','1a3','1b1','1b2','1c1','1c2','1c3','2a1','2a2','2b1','2b2','3a1','3a2','3b1','3b2','3c1','3c2','4a1','4a2','4b1','4b2','4b3','4b4','4c1','4c2','4c3','4d1','4d2','5a1','5a2','5b1','5b2','5b3','5b4','5c1','5c2','5c3','6a1','6a2','6b1','6b2','6b3','6c1','6c2','6d1','6d2','7a1','7a2','7a3','7b1','7b2'],
                                 'oac2':['1a', '1a', '1a', '1b', '1b', '1c', '1c', '1c', '2a', '2a', '2b', '2b', '3a', '3a', '3b', '3b', '3c', '3c', '4a', '4a', '4b', '4b', '4b', '4b', '4c', '4c', '4c', '4d', '4d', '5a', '5a', '5b', '5b', '5b', '5b', '5c', '5c', '5c', '6a', '6a', '6b', '6b', '6b', '6c', '6c', '6d', '6d', '7a', '7a', '7a', '7b', '7b'],
                                 'oac1':['1',  '1',   '1',  '1',  '1', '1',  '1',  '1',  '2',  '2',  '2',  '2',  '3',  '3',  '3',  '3',  '3',  '3',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '7',  '7',  '7',  '7',  '7']})
            else:
                lookup2001 = df({'oac3':['1A1','1A2','1A3','1B1','1B2','1C1','1C2','1C3','2A1','2A2','2B1','2B2','3A1','3A2','3B1','3B2','3C1','3C2','4A1','4A2','4B1','4B2','4B3','4B4','4C1','4C2','4C3','4D1','4D2','5A1','5A2','5B1','5B2','5B3','5B4','5C1','5C2','5C3','6A1','6A2','6B1','6B2','6B3','6C1','6C2','6D1','6D2','7A1','7A2','7A3','7B1','7B2'],
                     'oac2':['1A', '1A', '1A', '1B', '1B', '1C', '1C', '1C', '2A', '2A', '2B', '2B', '3A', '3A', '3B', '3B', '3C', '3C', '4A', '4A', '4B', '4B', '4B', '4B', '4C', '4C', '4C', '4D', '4D', '5A', '5A', '5B', '5B', '5B', '5B', '5C', '5C', '5C', '6A', '6A', '6B', '6B', '6B', '6C', '6C', '6D', '6D', '7A', '7A', '7A', '7B', '7B'],
                     'oac1':['1',  '1',   '1',  '1',  '1', '1',  '1',  '1',  '2',  '2',  '2',  '2',  '3',  '3',  '3',  '3',  '3',  '3',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '5',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '7',  '7',  '7',  '7',  '7']})
                
            regavspend = df(np.sum(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].loc[:,'1.1.1.1':'12.5.3.5'])/np.sum(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].loc[:,'weight']))
                
            temp1 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 1D']).sum()
            temp2 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 2D']).sum()
            temp3 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 3D']).sum()
            count1 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 1D']).count().iloc[:,0])
            count2 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 2D']).count().iloc[:,0])
            count3 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 3D']).count().iloc[:,0])
            
            count1['oac1t'] = count1.index.get_level_values(1)
            x = []
            for c in range(len(count1)):
                 x.append(str(count1.iloc[c,1]))
            count1['oac1'] = x
            count2['oac2'] = count2.index.get_level_values(1)
            count3['oac3'] = count3.index.get_level_values(1)
            
            count1 = count1.rename(columns={'weight':'oac1_count'})
            count2 = count2.rename(columns={'weight':'oac2_count'})
            count3 = count3.rename(columns={'weight':'oac3_count'})
                    
            spendbyoac1reg = temp1.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp1.loc[:,'weight'].values,(307,1)))
            spendbyoac2reg = temp2.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp2.loc[:,'weight'].values,(307,1)))
            spendbyoac3reg = temp3.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp3.loc[:,'weight'].values,(307,1)))
            
            lookup2001 = lookup2001.merge(count3,how='left')
            lookup2001 = lookup2001.merge(count2,how='left')
            lookup2001 = lookup2001.merge(count1,how='left')
            
            temp = df(np.zeros(shape = [52,307]),columns=spendbyoac1reg.columns,index=lookup2001['oac3'])
            
            for i,o in enumerate(temp.index):
                if lookup2001.loc[i,'oac3_count']>19:
                     temp.loc[o] = spendbyoac3reg.loc[(reg,o)]
                elif lookup2001.loc[i,'oac2_count']>19:
                    temp.loc[o] = spendbyoac2reg.loc[(reg,lookup2001.loc[i,'oac2'])]
                elif lookup2001.loc[i,'oac1_count']>19:
                    temp.loc[o] = spendbyoac1reg.loc[(reg,lookup2001.loc[i,'oac1t'])]
                else:
                    temp.loc[o] = np.transpose(regavspend.values)
      
            regspends[regions[reg-1]] = temp 
            lookup2001=lookup2001.set_index('oac3')
            regmeta[regions[reg-1]] = lookup2001 
            
            del(lookup2001,regavspend,temp1,temp2,temp3,count1,count2,count3,spendbyoac1reg,spendbyoac2reg,spendbyoac3reg,temp)
        
        oacyrspends[yr] = regspends
        oacyrmeta[yr] = regmeta
        
    for yr in oac_2011_years:
        
        regspends = {}
        regmeta = {}
            
        for reg in range(1,10):
            
            lookup2011 = df({'oac3':['1A1','1A2','1A3','1A4','1B1','1B2','1B3','1C1','1C2','1C3','2A1','2A2','2A3','2B1','2B2','2C1','2C2','2C3','2D1','2D2','2D3','3A1','3A2','3B1','3B2','3B3','3C1','3C2','3D1','3D2','3D3','4A1','4A2','4A3','4B1','4B2','4C1','4C2','4C3','5A1','5A2','5A3','5B1','5B2','5B3','6A1','6A2','6A3','6A4','6B1','6B2','6B3','6B4','7A1','7A2','7A3','7B1','7B2','7B3','7C1','7C2','7C3','7D1','7D2','7D3','7D4','8A1','8A2','8B1','8B2','8C1','8C2','8C3','8D1','8D2','8D3'],
                             'oac2':['1A', '1A', '1A', '1A', '1B', '1B', '1B', '1C', '1C', '1C', '2A', '2A', '2A', '2B', '2B', '2C', '2C', '2C', '2D', '2D', '2D', '3A', '3A', '3B', '3B', '3B', '3C', '3C', '3D', '3D', '3D', '4A', '4A', '4A', '4B', '4B', '4C', '4C', '4C', '5A', '5A', '5A', '5B', '5B', '5B', '6A', '6A', '6A', '6A', '6B', '6B', '6B', '6B', '7A', '7A', '7A', '7B', '7B', '7B', '7C', '7C', '7C', '7D', '7D', '7D', '7D', '8A', '8A', '8B', '8B', '8C', '8C', '8C', '8D', '8D', '8D'],
                             'oac1':['1',  '1',  '1',  '1',  '1',  '1',  '1',  '1',  '1',  '1',  '2',  '2',  '2',  '2',  '2',  '2',  '2',  '2',  '2',  '2',  '2',  '3',  '3',  '3',  '3',  '3',  '3',  '3',  '3',  '3',  '3',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '4',  '5',  '5',  '5',  '5',  '5',  '5',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '6',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '7',  '8',  '8',  '8',  '8',  '8',  '8',  '8',  '8',  '8',  '8']})
                
            regavspend = df(np.sum(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].loc[:,'1.1.1.1':'12.5.3.5'])/np.sum(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].loc[:,'weight']))
                
            temp1 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 1D']).sum()
            temp2 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 2D']).sum()
            temp3 = hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 3D']).sum()
            count1 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 1D']).count().iloc[:,0])
            count2 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 2D']).count().iloc[:,0])
            count3 = df(hhspenddata[yr][hhspenddata[yr]["GOR modified"] == reg].groupby(['GOR modified','OA class 3D']).count().iloc[:,0])
            
            count1['oac1t'] = count1.index.get_level_values(1)
            x = []
            for c in range(len(count1)):
                 x.append(str(count1.iloc[c,1]))
            count1['oac1'] = x
            count2['oac2'] = count2.index.get_level_values(1)
            count3['oac3'] = count3.index.get_level_values(1)
            
            count1 = count1.rename(columns={'weight':'oac1_count'})
            count2 = count2.rename(columns={'weight':'oac2_count'})
            count3 = count3.rename(columns={'weight':'oac3_count'})
                    
            spendbyoac1reg = temp1.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp1.loc[:,'weight'].values,(307,1)))
            spendbyoac2reg = temp2.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp2.loc[:,'weight'].values,(307,1)))
            spendbyoac3reg = temp3.loc[:,'1.1.1.1':'12.5.3.5']/np.transpose(np.tile(temp3.loc[:,'weight'].values,(307,1)))
            
            lookup2011 = lookup2011.merge(count3,how='left')
            lookup2011 = lookup2011.merge(count2,how='left')
            lookup2011 = lookup2011.merge(count1,how='left')
            
            temp = df(np.zeros(shape = [76,307]),columns=spendbyoac1reg.columns,index=lookup2011['oac3'])
            
            for i,o in enumerate(temp.index):
                if lookup2011.loc[i,'oac3_count']>19:
                     temp.loc[o] = spendbyoac3reg.loc[(reg,o)]
                elif lookup2011.loc[i,'oac2_count']>19:
                    temp.loc[o] = spendbyoac2reg.loc[(reg,lookup2011.loc[i,'oac2'])]
                elif lookup2011.loc[i,'oac1_count']>19:
                    temp.loc[o] = spendbyoac1reg.loc[(reg,lookup2011.loc[i,'oac1t'])]
                else:
                    temp.loc[o] = np.transpose(regavspend.values)
      
            regspends[regions[reg-1]] = temp 
            lookup2011=lookup2011.set_index('oac3')
            regmeta[regions[reg-1]] = lookup2011 
            
            del(lookup2011,regavspend,temp1,temp2,temp3,count1,count2,count3,spendbyoac1reg,spendbyoac2reg,spendbyoac3reg,temp)
        
        oacyrspends[yr] = regspends
        oacyrmeta[yr] = regmeta
    
    for yr in oac_none_years:
        
        oacyrspends[yr] = oacyrspends[2007]
        oacyrmeta[yr] = oacyrmeta[2007]
        

    return(oacyrspends,oacyrmeta)
    

def convert36to33(Y,concs_dict2,years):
    
    Y2 = {}
    
    for yr in years:
        temp = np.dot(Y[yr],concs_dict2['C43_to_C40'])
        Y2[yr] = df(temp, index = Y[yr].index, columns = concs_dict2['C43_to_C40'].columns)
    
    return Y2

def make_totals(hhspenddata,years):
    
    coicop_exp_tot = {}
    
    for yr in years:
        coicop_exp_tot[yr] = np.sum(hhspenddata[yr].loc[:,'1.1.1.1':'12.5.3.5'],0)#-np.sum(hhspenddata[yr].loc[:,'4.1.2'])
 
    return coicop_exp_tot


def make_balanced_totals(coicop_exp_tot,tax,total_Yhh_112,concs_dict2,years):
    
    coicop_exp_tot2 = {}
    
    for yr in years:
        corrector = np.zeros(shape = 307)
        countstart = 0
        countend = 0
        for numb in range(0,33):
            conc = concs_dict2[str(numb)+'a']
            countend = np.sum(np.sum(conc))+countstart
            lcf_subtotal = np.sum(np.dot(coicop_exp_tot[yr],conc)) #*52/1000)
            required_subtotal = np.sum(total_Yhh_112[yr].iloc[:,numb])
            correction_factor = required_subtotal/lcf_subtotal
            for c in range(countstart,countend):
                corrector[c] = correction_factor
            countstart = countend
        coicop_exp_tot2[yr] = np.dot(coicop_exp_tot[yr],np.diag(corrector))
    
    return coicop_exp_tot2


def make_y_hh_307(Y,coicop_exp_tot2,years,concs_dict2,meta):
    
    yhh_wide = {}
    
    for yr in years:
        temp = np.zeros(shape = [meta['fd']['len_idx'],307])
        countstart = 0
        countend = 0
        col = []
        for a in range(0,33):
            print(a)
            conc = np.tile(concs_dict2[str(a)],(meta['reg']['len'],1))
            countend = np.sum(np.sum(concs_dict2[str(a)+'a']))+countstart
            category_total = np.dot(coicop_exp_tot2[yr],concs_dict2[str(a)+'a'])
            #test1 = np.dot(np.diag(Y[yr].iloc[:,a]),conc)
            test1 = np.dot(conc,np.diag(category_total))
            #test2 = np.tile(np.dot(Y[yr].iloc[:,a],conc),(1590,1))
            test2 = np.transpose(np.tile(np.dot(conc,category_total),(np.size(conc,1),1)))
            test3 = test1/test2
            test3 = np.nan_to_num(test3, copy=True)
            #num = np.dot(conc,np.diag(category_total))
            #test4 = np.multiply(num,test3)
            test4 = np.dot(np.diag(Y[yr].iloc[:,a]),test3)
            #den = np.dot(np.diag(np.sum(num,1)),concs_dict2[str(a)])
            #prop = np.divide(num,den)
            #prop = np.nan_to_num(prop, copy=True)
            #temp[:,countstart:countend] = (np.dot(np.diag(total_Yhh_106[yr].iloc[:,a]),prop))
            temp[:,countstart:countend] = test4
            col[countstart:countend] = concs_dict2[str(a) + 'a'].columns
            countstart = countend
        yhh_wide[yr] = df(temp, columns = col)
            
    return yhh_wide


def make_y_hh_prop(Y,total_Yhh_106,meta,years):
    
    yhh_prop = {}
    
    for yr in years:
        temp = np.zeros(shape=(len(Y[yr])))
    
        for r in range(0,meta['reg']['len']):
            temp[r*106:(r+1)*106] = np.divide(np.sum(Y[yr].iloc[r*106:(r+1)*106,0:36],1),np.sum(total_Yhh_106[yr],1))
            np.nan_to_num(temp, copy = False)
        
        yhh_prop[yr] = temp

        
    return yhh_prop


def make_new_Y(Y,yhh_wide,meta,years):
    
    newY = {}
    col = []
    
    for yr in years:
        temp = np.zeros(shape=[len(Y[yr]),314])
        temp[:,0:307] = yhh_wide[yr]
        temp[:,307:314] = Y[yr].iloc[:,33:40]
        col[0:307] = yhh_wide[yr].columns
        col[307:314] = Y[yr].iloc[:,33:40].columns
        newY[yr] = df(temp, index = Y[yr].index, columns = col)
    
    return newY


def make_ylcf_props(hhspenddata,years):
    
    ylcf_props = {}
    
    for yr in years:
        totalspend = np.sum(hhspenddata[yr].loc[:,'1.1.1.1':'12.5.3.5'])
        temp = np.divide(hhspenddata[yr].loc[:,'1.1.1.1':'12.5.3.5'],np.tile(totalspend,[len(hhspenddata[yr]),1]))
        np.nan_to_num(temp, copy = False)
        ylcf_props[yr] = df(temp, index = hhspenddata[yr].index)
        
    return ylcf_props


def makefoot(S,U,Y,stressor,years):
    footbyCOICOP = {}
    for yr in years:
        temp = np.zeros(shape = 307)
        Z = io.make_Z_from_S_U(S[yr],U[yr]) 
        bigY = np.zeros(shape = [np.size(Y[yr],0)*2,np.size(Y[yr],1)])
        bigY[np.size(Y[yr],0):np.size(Y[yr],0)*2,0:] = Y[yr]     
        x = io.make_x(Z,bigY)
        L = io.make_L(Z,x)
        bigstressor = np.zeros(shape = [np.size(Y[yr],0)*2,1])
        bigstressor[0:np.size(Y[yr],0),:] = stressor[yr]
        e = np.sum(bigstressor,1)/x
        eL = np.dot(e,L)
        for a in range(0,307):
            temp[a] = np.dot(eL,bigY[:,a])
        footbyCOICOP[yr] = temp  

    return footbyCOICOP


def makefig1(S,U,Y,newY,stressor,years,concs_jcp,meta):
    allukprodbyuksourceind = {}
    allukprodbyimportsource = {}
    allukprodbyexport = {}
    ukconsprodbygov = {}
    ukconsprodbycap = {}
    impconsprodbygov = {}
    impconsprodbycap = {}
    ukconsprodbycoicop = {}
    impconsprodbycoicop = {}
    uk0_106mask = np.zeros(shape = [106,3180])
    uk0_106mask[:,0:106] = np.identity(106)
    uk1590_1696mask = np.zeros(shape = [3180,106])
    uk1590_1696mask[1590:1696,:] = np.identity(106)     
    allsectormask = np.zeros(shape = [3180,106])
    impsectormask = np.zeros(shape = [3180,106])
    impsectormask2 = np.zeros(shape = [3180,106])
    importmask = np.zeros(shape = [3180])
    importmask[106:1590] = np.ones(1484)
    
    for r in range(0,meta['reg']['len']):
        allsectormask[r*106+1590:(r+1)*106+1590,:] = np.identity(106)
        if r ==0:
            impsectormask[r*106+1590:(r+1)*106+1590,:] = np.zeros(106)
            impsectormask2[r*106:(r+1)*106,:] = np.zeros(106)
        else:
            impsectormask[r*106+1590:(r+1)*106+1590,:] = np.identity(106)
            impsectormask2[r*106:(r+1)*106,:] = np.identity(106)
    
    for yr in years:
        tempukconsprodbycoicop = np.zeros(shape = [3,36])
        tempdomimpconsprodbycoicop = np.zeros(shape = [3,36])
        tempimpimpconsprodbycoicop = np.zeros(shape = [36])
        Z = io.make_Z_from_S_U(S[yr],U[yr]) 
        bigY = np.zeros(shape = [np.size(Y[yr],0)*2,np.size(Y[yr],1)])
        bigY[np.size(Y[yr],0):np.size(Y[yr],0)*2,0:] = Y[yr]     
        x = io.make_x(Z,bigY)
        L = io.make_L(Z,x)
        bigstressor = np.zeros(shape = [np.size(Y[yr],0)*2,1])
        bigstressor[0:np.size(Y[yr],0),:] = stressor[yr]
        e = np.sum(bigstressor,1)/x
        foot = np.dot(np.dot(np.diag(e),L),np.diag(np.sum(bigY,1)))
        exportfoot = np.dot(np.dot(np.diag(e),L),np.diag(bigY[:,42]))
        govfoot = np.dot(np.dot(np.diag(e),L),np.diag(np.sum(bigY[:,36:39],1)))
        capfoot = np.dot(np.dot(np.diag(e),L),np.diag(np.sum(bigY[:,39:42],1)))
        ukfoot = np.dot(np.dot(np.diag(e),L),np.diag(np.sum(bigY[:,0:42],1)))
        
        tempallukprodbyuksourceind = np.dot(np.dot(np.transpose(concs_jcp['ind_conc']),np.dot(foot[0:106,:],allsectormask)),concs_jcp['prod_conc'])
        tempallukprodbyimportsource = np.dot(np.sum(np.dot(ukfoot,uk1590_1696mask)[106:1590,:],0),concs_jcp['prod_conc'])
        tempallukprodbyexport = np.dot(np.sum(np.dot(np.dot(uk0_106mask,exportfoot),allsectormask),0),concs_jcp['prod_conc'])
        for a in range(0,36):
            tempukconsprodbycoicop[:,a] = np.sum(np.dot(np.dot(np.dot(uk0_106mask,np.dot(np.dot(np.diag(e),L),np.diag(bigY[:,a]))),allsectormask),concs_jcp['prod_conc']),0)
            tempdomimpconsprodbycoicop[:,a] = np.dot(np.sum(np.dot(np.dot(np.transpose(impsectormask2),np.dot(np.dot(np.diag(e),L),np.diag(bigY[:,a]))),uk1590_1696mask),0),concs_jcp['prod_conc'])
            tempimpimpconsprodbycoicop[a] = np.sum(np.sum(np.dot(np.dot(np.diag(e),L),np.diag(bigY[:,a]))[106:1590,1696:3180]))
        tempukconsprodbygov = np.dot(np.sum(np.dot(np.dot(uk0_106mask,govfoot),allsectormask),0),concs_jcp['prod_conc'])
        tempukconsprodbycap = np.dot(np.sum(np.dot(np.dot(uk0_106mask,capfoot),allsectormask),0),concs_jcp['prod_conc'])
        tempukconsprodbygov2 = np.dot(np.dot(importmask,np.dot(govfoot,uk1590_1696mask)),concs_jcp['prod_conc'])
        tempukconsprodbycap2 = np.dot(np.dot(importmask,np.dot(capfoot,uk1590_1696mask)),concs_jcp['prod_conc'])     
        tempimpconsprodbygov = np.sum(np.sum(capfoot[106:1590,1696:3180]))
        tempimpconsprodbycap = np.sum(np.sum(govfoot[106:1590,1696:3180]))
        temp = tempukconsprodbycoicop+tempdomimpconsprodbycoicop
        temp1 = tempukconsprodbygov+tempukconsprodbygov2
        temp2 = tempukconsprodbycap+tempukconsprodbycap2
    
    allukprodbyuksourceind[yr] = df(tempallukprodbyuksourceind, index = concs_jcp['ind_conc'].columns, columns = concs_jcp['prod_conc'].columns)
    allukprodbyimportsource[yr] = df(tempallukprodbyimportsource, index = concs_jcp['prod_conc'].columns)
    allukprodbyexport[yr] = df(tempallukprodbyexport,index = concs_jcp['prod_conc'].columns)
    ukconsprodbycoicop[yr] = df(np.dot(temp,concs_jcp['coiciop_conc']), index = concs_jcp['prod_conc'].columns,columns = concs_jcp['coiciop_conc'].columns)
    ukconsprodbygov[yr] = df(temp1,index = concs_jcp['prod_conc'].columns)
    ukconsprodbycap[yr] = df(temp2,index = concs_jcp['prod_conc'].columns)
    impconsprodbygov[yr] = tempimpconsprodbygov
    impconsprodbycap[yr] = tempimpconsprodbycap
    impconsprodbycoicop[yr] = df(np.dot(tempimpimpconsprodbycoicop,concs_jcp['coiciop_conc']), index = concs_jcp['coiciop_conc'].columns)
   
    return (allukprodbyuksourceind,allukprodbyimportsource,allukprodbyexport,ukconsprodbycoicop,ukconsprodbygov,ukconsprodbycap,impconsprodbygov,impconsprodbycap,impconsprodbycoicop)


def makelcffootdata(domfootbyLCF_nrg,impfootbyLCF_nrg,hhspenddata,years):
    
    data = {}
    
    for yr in years:
        temp = np.zeros(shape = [len(domfootbyLCF_nrg[yr]),307+307+17])
        cols = ['index','weight','age','sex','ethnicity','number of people','household type','dwelling type','tenure type','GOR','OAC','income','income tax','Soc-ec','no of rooms','cum sum','income rank',]
        temp[:,0] = hhspenddata[yr].index
        temp[:,1:10] = hhspenddata[yr].loc[:,'weight':'GOR modified']
        for a in range(0,len(hhspenddata[yr])):
            if hhspenddata[yr].iloc[a,9] == ' ':
                temp[a,10] = 0
            else:
                temp[a,10] = int(hhspenddata[yr].iloc[a,9])
        temp[:,11:15] = hhspenddata[yr].loc[:,'Income anonymised':'rooms in accommodation']        
        cols[17:324] = hhspenddata[yr].loc[:,'1.1.1.1':'12.5.3.5'].columns
        cols[341:631] = hhspenddata[yr].loc[:,'1.1.1.1':'12.5.3.5'].columns
        temp[:,17:17+307] = domfootbyLCF_nrg[yr][:,0:307]
        temp[:,17+307:17+307+307] = impfootbyLCF_nrg[yr][:,0:307]
        temp2 = df(temp,columns = cols)
        temp3 = temp2.sort_values('income')
        weightsum = np.sum(temp3.loc[:,'weight'])
        weightsum20 = weightsum/20
        temp3.iloc[0,15] = temp3.iloc[0,1]
        for a in range(1,len(domfootbyLCF_nrg[yr])):
            temp3.iloc[a,15] = temp3.iloc[a-1,15] +  temp3.iloc[a,1] 
        a=0 
        for b in range(0,len(domfootbyLCF_nrg[yr])): 
               
            if temp3.iloc[b,15]<(a+1)*weightsum20:
                temp3.iloc[b,16] = a
            else:
                a=a+1    
        temp3.iloc[b,16] = a-1    
        data[yr] = temp3    
        
    return data

def make_pop_hhold_by_oac_region_year(oa_lookup01,oa_lookup11,census_filepath,regions):
    regoacsyr = {}
   
    file = os.path.join(census_filepath, '2001oac.csv') 
    oac01 = pd.read_csv(file, encoding="iso8859_15", index_col = 0)   
    oac2001pophh = oac01.join(oa_lookup01)
        
    for yr in range(2001,2014):
        regoacs = {}
        for r in regions:
            if yr == 2001:
                temp = oac2001pophh[oac2001pophh['REG'] == r].groupby(['LAD','AC Subgroup']).sum()
                temp = temp.rename(columns={'UV0010001': 'pop','ks0200001':'hholds'})
                temp['LAD_code'] = temp.index.get_level_values(0)
                temp['OAC_code'] = temp.index.get_level_values(1)
                regoacs[r] = temp
            else:
                temp = oac2001pophh[oac2001pophh['REG'] == r].groupby(['LAD','AC Subgroup']).sum()
                temp = temp.rename(columns={'UV0010001': 'pop','ks0200001':'hholds'})
                temp['LAD_code'] = temp.index.get_level_values(0)
                temp['OAC_code'] = temp.index.get_level_values(1)
            
                file = os.path.join(census_filepath, 'MYEB3_summary_components_of_change_series_UK_(2018_geog19).csv') 
                data = pd.read_csv(file, encoding="iso8859_15", index_col = 0) 
                data['popprop'] = data['population_' +str(yr)]/data['population_2001']
                data['LAD_code'] = data.index
                fred = temp.merge(data,how='left')
                fred.index = temp.index
                temp['pop'] = temp['pop']*fred['popprop']
                temp['hholds'] = temp['hholds']*fred['popprop']
                
                regoacs[r] = temp
        regoacsyr[yr] = regoacs
            
    regions2 = ['north-east','north-west','yorkshire-and-the-humber','east-midlands','west-midlands','east','london','south-east','south-west']
    
    file = os.path.join(census_filepath, 'oa2011pop.csv') 
    pop = pd.read_csv(file, encoding="iso8859_15", index_col = 0) 
    file = os.path.join(census_filepath, 'oa2011hhold.csv') 
    hhold = pd.read_csv(file, encoding="iso8859_15", index_col = 0) 
    file = os.path.join(census_filepath, '2011 OAC Clusters and Names csv v2.csv') 
    oac11 = pd.read_csv(file, encoding="iso8859_15", index_col = 0) 
     
    oac2011pophh = oac11.join(pop)
    oac2011pophh = oac2011pophh.join(hhold)
    oac2011pophh = oac2011pophh.join(oa_lookup11)
                
    for yr in range(2014,2019):
        regoacs = {}
                    
        for i,r in enumerate(regions):
             temp = oac2011pophh[oac2011pophh['Region/Country Name'] == r]
                 
             f='mid-' +str(yr) +'-coa-unformatted-syoa-estimates-' +regions2[i] +'.xlsx'
             file = os.path.join(census_filepath, f) 
             sn = 'Mid-'+str(yr) +' Persons'
             data = pd.read_excel(file,sheet_name = sn,index_col=0,header=3) 
             newpop = df(data['All Ages'])
             
             fred = temp.join(newpop)
             fred['popprop'] = fred['All Ages']/fred['pop']
             temp['pop'] = temp['pop']*fred['popprop']
             temp['hholds'] = temp['hholds']*fred['popprop']
             
             temp2 = temp.groupby(['LAD','Subgroup Code']).sum()
             temp2['LAD_code'] = temp2.index.get_level_values(0)
             temp2['OAC_code'] = temp2.index.get_level_values(1)
             temp2 = temp2.rename(columns={'Supergroup Code': 'AC supergroup'})
             
             regoacs[r] = temp2
        
        regoacsyr[yr] = regoacs

    return regoacsyr  


def correct_index(oacyrspends,regions):
    
    for yr in range(2008,2019):
        for r in regions:
            newindex = []
            for n in range(0,len(oacyrspends[yr][r])):
                newindex.append(oacyrspends[yr][r].index[n].upper())
            oacyrspends[yr][r] = df(oacyrspends[yr][r].values, index = newindex, columns = oacyrspends[yr][r].columns)

    return oacyrspends
  

def make_la_spends_pop_by_region_year(regoacsyr,oacyrspends,regions,years):
    
    reglaspendyr = {}
    regpophholdsyr = {}

    for yr in years:
        reglaspend = {}
        regpophholds = {}
        
        for r in regions:
            ladspend = df(np.zeros(shape=(len(regoacsyr[yr][r]),307)),index=regoacsyr[yr][r].index,columns=oacyrspends[yr][r].columns)
            for n in range(0,len(regoacsyr[yr][r])):
                ladspend.iloc[n] = np.transpose(regoacsyr[yr][r]['hholds'][n]*oacyrspends[yr][r].loc[regoacsyr[yr][r]['OAC_code'][n].upper()])
            ladspend['LAD_code'] = ladspend.index.get_level_values(0)
            ladspend = ladspend.groupby(['LAD_code']).sum()
            ladpophholds = regoacsyr[yr][r].groupby(['LAD_code']).sum()
            
            reglaspend[r] = ladspend
            regpophholds[r] = ladpophholds
            
        reglaspendyr[yr] = reglaspend
        regpophholdsyr[yr] = regpophholds

    return (reglaspendyr,regpophholdsyr)  


def correct_reglaspendyr_zero(reglaspendyr,regions,years):
    
    for yr in years:
        for r in regions:
            total = np.sum(reglaspendyr[yr][r].values,1)
            for s in reglaspendyr[yr][r].columns:
                if np.sum(reglaspendyr[yr][r][s])==0:
                   reglaspendyr[yr][r][s] = total 
            
    return reglaspendyr

def make_la_spend_props_by_region_year(reglaspendyr,regions,years):
    
    reglaspropyr = {}

    for yr in years:
        regpropspend = {}
    
        for r in regions:
            total = np.sum(reglaspendyr[yr][r])
            prop  = np.divide(reglaspendyr[yr][r], np.tile(total,[len(reglaspendyr[yr][r]),1]))
            prop=prop.fillna(0)
        
            regpropspend[r] = prop
    
        reglaspropyr[yr] = regpropspend

    return reglaspropyr


def correct_la_spend_props_gas_elec(reglaspropyr,regions,regions_lc,years):
    
    filepath = '/earao/Source Data/IEA/'
    file = os.path.join(filepath, 'Sub-national_energy_consumption_statistics_2005-2019.xlsx')
    for i,r in enumerate(regions_lc):
        gas_prop = pd.read_excel(file, sheet_name = [r+'_prop_gas'], index_col = 0)
        elc_prop = pd.read_excel(file, sheet_name = [r+'_prop_elec'], index_col = 0)
        
        for yr in years:
            reglaspropyr[yr][regions[i]]['4.4.1'] = elc_prop[r+'_prop_elec'][yr]
            reglaspropyr[yr][regions[i]]['4.4.2'] = gas_prop[r+'_prop_gas'][yr]
            
    return reglaspropyr
   

def make_y_regions(hhspenddata,newY,years):
    y_regions={}
    ytemp = np.zeros((np.size(newY[2001],0),314))
    for yr in years:
        temp = np.sum(hhspenddata[yr],0) 
        temp[temp == 0] = 0.000000001
        totalhholdspend = temp.loc['1.1.1.1':'12.5.3.5']
        totalpop = temp.loc['weight']
        temp = hhspenddata[yr].groupby(['GOR modified']).sum()
        spendbyregion = temp.loc[:,'1.1.1.1':'12.5.3.5']
        regpop = temp.loc[:,'weight']
        for reg in range(1,13):
            prop_spend = spendbyregion.loc[reg,:]/totalhholdspend
            prop_pop = regpop.loc[reg]/totalpop
            ytemp[:,0:307] = np.multiply(newY[yr].iloc[:,0:307],np.tile(np.transpose(prop_spend),(np.size(newY[2001],0),1)))
            ytemp[:,307:314] = np.multiply(newY[yr].iloc[:,307:314],np.tile(prop_pop,(np.size(newY[2001],0),7)))
            y_regions[str(yr)+'_'+str(reg)] = df(ytemp,index=newY[yr].index,columns=newY[yr].columns)
            y_regions[str(yr)+'_'+str(reg)] = y_regions[str(yr)+'_'+str(reg)].fillna(0)
    return y_regions


def make_y_regions_2021(hhspenddata,newY,years):
    y_regions={}
    ytemp = np.zeros((np.size(newY[2001],0),314))
    filepath = '/earao/Source Data/IEA/'
    file = os.path.join(filepath, 'Sub-national_energy_consumption_statistics_2005-2019.xlsx')
    gas_prop = pd.read_excel(file, sheet_name = 'reg_prop_gas', index_col = 0)
    elc_prop = pd.read_excel(file, sheet_name = 'reg_prop_elec', index_col = 0)

    for yr in years:
        temp = np.sum(hhspenddata[yr],0) 
        temp[temp == 0] = 0.000000001
        totalhholdspend = temp.loc['1.1.1.1':'12.5.3.5']
        totalpop = temp.loc['weight']
        temp = hhspenddata[yr].groupby(['GOR modified']).sum()
        spendbyregion = temp.loc[:,'1.1.1.1':'12.5.3.5']
        regpop = temp.loc[:,'weight']
        for reg in range(1,13):
            prop_spend = spendbyregion.loc[reg,:]/totalhholdspend
            prop_spend.loc['4.4.1'] = elc_prop.loc[reg,yr]
            prop_spend.loc['4.4.2'] = gas_prop.loc[reg,yr]
            prop_pop = regpop.loc[reg]/totalpop
            ytemp[:,0:307] = np.multiply(newY[yr].iloc[:,0:307],np.tile(np.transpose(prop_spend),(np.size(newY[2001],0),1)))
            ytemp[:,307:314] = np.multiply(newY[yr].iloc[:,307:314],np.tile(prop_pop,(np.size(newY[2001],0),7)))
            y_regions[str(yr)+'_'+str(reg)] = df(ytemp,index=newY[yr].index,columns=newY[yr].columns)
            y_regions[str(yr)+'_'+str(reg)] = y_regions[str(yr)+'_'+str(reg)].fillna(0)
    return y_regions

def make_y_countries(y_regions,years):
    y_England={}
    y_N_Ireland={}
    y_Scotland={}
    y_Wales={}
    for yr in years:
        temp = np.zeros((np.size(y_regions['2001_1'],0),314))
        for reg in range(1,10):
            temp = temp+y_regions[str(yr)+'_'+str(reg)].values
        y_England[yr] = df(temp,index=y_regions[str(yr)+'_1'].index,columns=y_regions[str(yr)+'_1'].columns)
        y_N_Ireland[yr] = df(y_regions[str(yr)+'_12'].values,index=y_regions[str(yr)+'_12'].index,columns=y_regions[str(yr)+'_12'].columns)
        y_Scotland[yr] = df(y_regions[str(yr)+'_11'].values,index=y_regions[str(yr)+'_11'].index,columns=y_regions[str(yr)+'_11'].columns)
        y_Wales[yr] = df(y_regions[str(yr)+'_10'].values,index=y_regions[str(yr)+'_10'].index,columns=y_regions[str(yr)+'_10'].columns)
    return (y_England,y_N_Ireland,y_Scotland,y_Wales)


def make_y_north_east(y_regions,years):
    y_north_east={}
    for yr in years:
        y_north_east[yr] = df(y_regions[str(yr)+'_1'].values,index=y_regions[str(yr)+'_1'].index,columns=y_regions[str(yr)+'_1'].columns)
    return y_north_east

def make_y_north_west(y_regions,years):
    y_north_west={}
    for yr in years:
        y_north_west[yr] = df(y_regions[str(yr)+'_2'].values,index=y_regions[str(yr)+'_2'].index,columns=y_regions[str(yr)+'_2'].columns)
    return y_north_west

def make_y_yorkshire_and_the_humber(y_regions,years):
    y_yorkshre_and_the_humber={}
    for yr in years:
        y_yorkshre_and_the_humber[yr] = df(y_regions[str(yr)+'_3'].values,index=y_regions[str(yr)+'_3'].index,columns=y_regions[str(yr)+'_3'].columns)
    return y_yorkshre_and_the_humber

def make_y_east_midlands(y_regions,years):
    y_east_midlands={}
    for yr in years:
        y_east_midlands[yr] = df(y_regions[str(yr)+'_4'].values,index=y_regions[str(yr)+'_4'].index,columns=y_regions[str(yr)+'_4'].columns)
    return y_east_midlands

def make_y_west_midlands(y_regions,years):
    y_west_midlands={}
    for yr in years:
        y_west_midlands[yr] = df(y_regions[str(yr)+'_5'].values,index=y_regions[str(yr)+'_5'].index,columns=y_regions[str(yr)+'_5'].columns)
    return y_west_midlands

def make_y_east(y_regions,years):
    y_east={}
    for yr in years:
        y_east[yr] = df(y_regions[str(yr)+'_6'].values,index=y_regions[str(yr)+'_6'].index,columns=y_regions[str(yr)+'_6'].columns)
    return y_east

def make_y_london(y_regions,years):
    y_london={}
    for yr in years:
        y_london[yr] = df(y_regions[str(yr)+'_7'].values,index=y_regions[str(yr)+'_7'].index,columns=y_regions[str(yr)+'_7'].columns)
    return y_london

def make_y_south_east(y_regions,years):
    y_south_east={}
    for yr in years:
        y_south_east[yr] = df(y_regions[str(yr)+'_8'].values,index=y_regions[str(yr)+'_8'].index,columns=y_regions[str(yr)+'_8'].columns)
    return y_south_east

def make_y_south_west(y_regions,years):
    y_south_west={}
    for yr in years:
        y_south_west[yr] = df(y_regions[str(yr)+'_9'].values,index=y_regions[str(yr)+'_9'].index,columns=y_regions[str(yr)+'_9'].columns)
    return y_south_west

def make_y_scotland(y_regions,years):
    y_scotland={}
    for yr in years:
        y_scotland[yr] = df(y_regions[str(yr)+'_10'].values,index=y_regions[str(yr)+'_10'].index,columns=y_regions[str(yr)+'_10'].columns)
    return y_scotland

def make_y_wales(y_regions,years):
    y_wales={}
    for yr in years:
        y_wales[yr] = df(y_regions[str(yr)+'_11'].values,index=y_regions[str(yr)+'_11'].index,columns=y_regions[str(yr)+'_11'].columns)
    return y_wales

def make_y_northern_ireland(y_regions,years):
    y_northern_ireland={}
    for yr in years:
        y_northern_ireland[yr] = df(y_regions[str(yr)+'_12'].values,index=y_regions[str(yr)+'_12'].index,columns=y_regions[str(yr)+'_12'].columns)
    return y_northern_ireland



def make_conversions_domestic_imported(S,U,Y,newY,coicop_exp_tot,meta,stressor,direct,indicator,years):
    coicop = np.zeros((np.size(newY[2016],1)-1,len(years)))
    coicop2 = np.zeros((np.size(newY[2016],1)-1,len(years)))
    coicop_dom = np.zeros((np.size(newY[2016],1)-1,len(years)))
    coicop2_dom = np.zeros((np.size(newY[2016],1)-1,len(years)))
    coicop_imp = np.zeros((np.size(newY[2016],1)-1,len(years)))
    coicop2_imp = np.zeros((np.size(newY[2016],1)-1,len(years)))
    data = {}
    data_dom = {}
    data_imp = {}
    for i,yr in enumerate(years): 
        print(yr)
        Z = io.make_Z_from_S_U(S[yr],U[yr])
        bigY = np.zeros(shape = [np.size(Y[yr],0)*2,np.size(Y[yr],1)])
        bigY[np.size(Y[yr],0):np.size(Y[yr],0)*2,0:np.size(Y[yr],1)] = Y[yr]
        newbigY = np.zeros(shape = [np.size(newY[yr],0)*2,np.size(newY[yr],1)])
        newbigY[np.size(Y[yr],0):np.size(newY[yr],0)*2,0:np.size(newY[yr],1)] = newY[yr]
        x = io.make_x(Z,bigY)
        L = io.make_L(Z,x)
        bigstressor = np.zeros(shape = [np.size(Y[yr],0)*2,1])
        bigstressor[0:np.size(Y[yr],0),:] = stressor[yr]
        e = np.sum(bigstressor,1)/x 
        eL_vector = np.dot(e,L)
        eL_vector_dom = np.zeros(shape = [np.size(eL_vector)])
        eL_vector_dom[1590:1590+106] =eL_vector[1590:1590+106] 
        eL_vector_imp = np.zeros(shape = [np.size(eL_vector)])
        eL_vector_imp[1590+106:] =eL_vector[1590+106:]
      
        for ysec2 in range (0,np.size(newY[yr],1)-1):
            coicop[ysec2,i] = np.dot(eL_vector,newbigY[:,ysec2])
            coicop_dom[ysec2,i] = np.dot(eL_vector_dom,newbigY[:,ysec2])
            coicop_imp[ysec2,i] = np.dot(eL_vector_imp,newbigY[:,ysec2])
        if indicator == 'ghg':
            coicop[101,i] = coicop[101,i] + direct.loc['Consumer expenditure - not travel',yr]
            coicop[160,i] = coicop[160,i] + direct.loc['Consumer expenditure - travel',yr]
            coicop_dom[101,i] = coicop[101,i] + direct.loc['Consumer expenditure - not travel',yr]
            coicop_dom[160,i] = coicop[160,i] + direct.loc['Consumer expenditure - travel',yr]
                  
        coicop2[0:307,i] = (coicop[0:307,i]*1000000)/(coicop_exp_tot[yr].values*52*1000)
        coicop2[307,i] =  (coicop[307,i]*1000000)/(np.sum(Y[yr].loc[:,'Non-profit\r\ninstns serving\r\nhouseholds'],0)*1000000)
        coicop2[308,i] =  (coicop[308,i]*1000000)/(np.sum(Y[yr].loc[:,'Central\r\ngovernment'],0)*1000000)
        coicop2[309,i] =  (coicop[309,i]*1000000)/(np.sum(Y[yr].loc[:,'Local\r\nAuthorities'],0)*1000000)
        coicop2[310,i] =  (coicop[310,i]*1000000)/(np.sum(Y[yr].loc[:,'Gross fixed\r\ncapital\r\nformation'],0)*1000000)
        coicop2[311,i] =  (coicop[311,i]*1000000)/(np.sum(Y[yr].loc[:,'Valuables'],0)*1000000)
        coicop2[312,i] =  (coicop[312,i]*1000000)/(np.sum(Y[yr].loc[:,'Changes in inventories'],0)*1000000)  
        coicop2_dom[0:307,i] = (coicop_dom[0:307,i]*1000000)/(coicop_exp_tot[yr].values*52*1000)
        coicop2_dom[307,i] =  (coicop_dom[307,i]*1000000)/(np.sum(Y[yr].loc[:,'Non-profit\r\ninstns serving\r\nhouseholds'],0)*1000000)
        coicop2_dom[308,i] =  (coicop_dom[308,i]*1000000)/(np.sum(Y[yr].loc[:,'Central\r\ngovernment'],0)*1000000)
        coicop2_dom[309,i] =  (coicop_dom[309,i]*1000000)/(np.sum(Y[yr].loc[:,'Local\r\nAuthorities'],0)*1000000)
        coicop2_dom[310,i] =  (coicop_dom[310,i]*1000000)/(np.sum(Y[yr].loc[:,'Gross fixed\r\ncapital\r\nformation'],0)*1000000)
        coicop2_dom[311,i] =  (coicop_dom[311,i]*1000000)/(np.sum(Y[yr].loc[:,'Valuables'],0)*1000000)
        coicop2_dom[312,i] =  (coicop_dom[312,i]*1000000)/(np.sum(Y[yr].loc[:,'Changes in inventories'],0)*1000000)  
        coicop2_imp[0:307,i] = (coicop_imp[0:307,i]*1000000)/(coicop_exp_tot[yr].values*52*1000)
        coicop2_imp[307,i] =  (coicop_imp[307,i]*1000000)/(np.sum(Y[yr].loc[:,'Non-profit\r\ninstns serving\r\nhouseholds'],0)*1000000)
        coicop2_imp[308,i] =  (coicop_imp[308,i]*1000000)/(np.sum(Y[yr].loc[:,'Central\r\ngovernment'],0)*1000000)
        coicop2_imp[309,i] =  (coicop_imp[309,i]*1000000)/(np.sum(Y[yr].loc[:,'Local\r\nAuthorities'],0)*1000000)
        coicop2_imp[310,i] =  (coicop_imp[310,i]*1000000)/(np.sum(Y[yr].loc[:,'Gross fixed\r\ncapital\r\nformation'],0)*1000000)
        coicop2_imp[311,i] =  (coicop_imp[311,i]*1000000)/(np.sum(Y[yr].loc[:,'Valuables'],0)*1000000)
        coicop2_imp[312,i] =  (coicop_imp[312,i]*1000000)/(np.sum(Y[yr].loc[:,'Changes in inventories'],0)*1000000)  
    
    data['coicop_conv'] = df(coicop2, index = newY[yr].columns[0:np.size(newY[yr],1)-1], columns = years)  
    data_dom['coicop_conv'] = df(coicop2_dom, index = newY[yr].columns[0:np.size(newY[yr],1)-1], columns = years)  
    data_imp['coicop_conv'] = df(coicop2_imp, index = newY[yr].columns[0:np.size(newY[yr],1)-1], columns = years)  
   
    return (data,data_dom,data_imp)


def make_2001(file1,file2):
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
    person_data = df()
    person_data['person_no'] = dvper['PERSON']
    person_data['ethnicity_hrp'] = dvper['A012P']
    person_data['ethnicity partner hrp'] = dvper['A013P']
    person_data['income tax'] = np.zeros(shape=np.size(dvper,0))
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['WEIGHTA']
    useful_data['age HRP'] = dvhh['P396P']
    useful_data['sex HRP'] = dvhh['SEXHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['GORX']
    useful_data['OA class 1D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['INCANON']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['A114']
    useful_data['1.1.1.1'] = dvhh['C11111T']*dvhh['WEIGHTA']
    useful_data['1.1.1.2'] = dvhh['C11121T']*dvhh['WEIGHTA']
    useful_data['1.1.1.3'] = dvhh['C11151T']*dvhh['WEIGHTA']
    useful_data['1.1.2'] = dvhh['C11131T']*dvhh['WEIGHTA']
    useful_data['1.1.3.1'] = dvhh['C11122T']*dvhh['WEIGHTA']
    useful_data['1.1.3.2'] = dvhh['C11141T']*dvhh['WEIGHTA']
    useful_data['1.1.4'] = dvhh['C11142T']*dvhh['WEIGHTA']
    useful_data['1.1.5'] = dvhh['C11211T']*dvhh['WEIGHTA']
    useful_data['1.1.6'] = dvhh['C11221T']*dvhh['WEIGHTA']
    useful_data['1.1.7'] = dvhh['C11231T']*dvhh['WEIGHTA']
    useful_data['1.1.8'] = dvhh['C11241T']*dvhh['WEIGHTA']
    useful_data['1.1.9'] = dvhh['C11252T']*dvhh['WEIGHTA']
    useful_data['1.1.10.1'] = dvhh['C11251T']*dvhh['WEIGHTA']
    useful_data['1.1.10.2'] = dvhh['C11253T']*dvhh['WEIGHTA']
    useful_data['1.1.10.3'] = dvhh['C11261T']*dvhh['WEIGHTA']
    useful_data['1.1.10.4'] = dvhh['C11271T']*dvhh['WEIGHTA']
    useful_data['1.1.11.1'] = dvhh['C11311T']*dvhh['WEIGHTA']
    useful_data['1.1.11.2'] = (dvhh['C11321T']+dvhh['C11331T'])*dvhh['WEIGHTA']
    useful_data['1.1.11.3'] = dvhh['C11341T']*dvhh['WEIGHTA']
    useful_data['1.1.12.1'] = dvhh['C11411T']*dvhh['WEIGHTA']
    useful_data['1.1.12.2'] = dvhh['C11421T']*dvhh['WEIGHTA']
    useful_data['1.1.12.3'] = dvhh['C11431T']*dvhh['WEIGHTA']
    useful_data['1.1.13'] = dvhh['C11451T']*dvhh['WEIGHTA']
    useful_data['1.1.14'] = dvhh['C11471T']*dvhh['WEIGHTA']
    useful_data['1.1.15.1'] = dvhh['C11461T']*dvhh['WEIGHTA']
    useful_data['1.1.15.2'] = dvhh['C11441T']*dvhh['WEIGHTA']
    useful_data['1.1.16'] = dvhh['C11511T']*dvhh['WEIGHTA']
    useful_data['1.1.17'] = (dvhh['C11521T']+dvhh['C11522T'])*dvhh['WEIGHTA']
    useful_data['1.1.18.1'] = dvhh['C11531T']*dvhh['WEIGHTA']
    useful_data['1.1.18.2'] = (dvhh['C11541T']+dvhh['C11551T'])*dvhh['WEIGHTA']
    useful_data['1.1.19.1'] = dvhh['C11611T']*dvhh['WEIGHTA']
    useful_data['1.1.19.2'] = dvhh['C11621T']*dvhh['WEIGHTA']
    useful_data['1.1.19.3'] = dvhh['C11631T']*dvhh['WEIGHTA']
    useful_data['1.1.19.4'] = dvhh['C11641T']*dvhh['WEIGHTA']
    useful_data['1.1.19.5'] = dvhh['C11651T']*dvhh['WEIGHTA']
    useful_data['1.1.19.6'] = dvhh['C11661T']*dvhh['WEIGHTA']
    useful_data['1.1.20'] = dvhh['C11671T']*dvhh['WEIGHTA']
    useful_data['1.1.21'] = dvhh['C11681T']*dvhh['WEIGHTA']
    useful_data['1.1.22'] = dvhh['C11691T']*dvhh['WEIGHTA']
    useful_data['1.1.23.1'] = dvhh['C11711T']*dvhh['WEIGHTA']
    useful_data['1.1.23.2'] = dvhh['C11721T']*dvhh['WEIGHTA']
    useful_data['1.1.23.3'] = dvhh['C11731T']*dvhh['WEIGHTA']
    useful_data['1.1.23.4'] = dvhh['C11741T']*dvhh['WEIGHTA']
    useful_data['1.1.24'] = dvhh['C11751T']*dvhh['WEIGHTA']
    useful_data['1.1.25'] = dvhh['C11761T']*dvhh['WEIGHTA']
    useful_data['1.1.26'] = dvhh['C11771T']*dvhh['WEIGHTA']
    useful_data['1.1.27'] = dvhh['C11781T']*dvhh['WEIGHTA']
    useful_data['1.1.28.1'] = dvhh['C11811T']*dvhh['WEIGHTA']
    useful_data['1.1.28.2'] = dvhh['C11861T']*dvhh['WEIGHTA']
    useful_data['1.1.29'] = dvhh['C11821T']*dvhh['WEIGHTA']
    useful_data['1.1.30'] = dvhh['C11831T']*dvhh['WEIGHTA']
    useful_data['1.1.31'] = dvhh['C11841T']*dvhh['WEIGHTA']
    useful_data['1.1.32'] = dvhh['C11851T']*dvhh['WEIGHTA']
    useful_data['1.1.33.1'] = dvhh['C11911T']*dvhh['WEIGHTA']
    useful_data['1.1.33.2'] = dvhh['C11931T']*dvhh['WEIGHTA']
    useful_data['1.1.33.3'] = (dvhh['C11921T']+dvhh['C11941T'])*dvhh['WEIGHTA']
    useful_data['1.2.1'] = dvhh['C12111T']*dvhh['WEIGHTA']
    useful_data['1.2.2'] = dvhh['C12121T']*dvhh['WEIGHTA']
    useful_data['1.2.3'] = dvhh['C12131T']*dvhh['WEIGHTA']
    useful_data['1.2.4'] = (dvhh['C12231T']+dvhh['C12241T'])*dvhh['WEIGHTA']
    useful_data['1.2.5'] = dvhh['C12211T']*dvhh['WEIGHTA']
    useful_data['1.2.6'] = dvhh['C12221T']*dvhh['WEIGHTA']
    useful_data['2.1.1'] = dvhh['C21111T']*dvhh['WEIGHTA']
    useful_data['2.1.2.1'] = dvhh['C21211T']*dvhh['WEIGHTA']
    useful_data['2.1.2.2'] = dvhh['C21212T']*dvhh['WEIGHTA']
    useful_data['2.1.2.3'] = dvhh['C21221T']*dvhh['WEIGHTA']
    useful_data['2.1.3.1'] = dvhh['C21211T']*dvhh['WEIGHTA']
    useful_data['2.1.3.2'] = dvhh['C21213T']*dvhh['WEIGHTA']
    useful_data['2.1.4'] = dvhh['C21214T']*dvhh['WEIGHTA']
    useful_data['2.2.1'] = dvhh['C22111T']*dvhh['WEIGHTA']
    useful_data['2.2.2.1'] = dvhh['C22121T']*dvhh['WEIGHTA']
    useful_data['2.2.2.2'] = dvhh['C22131T']*dvhh['WEIGHTA']
    useful_data['3.1.1'] = dvhh['C31211T']*dvhh['WEIGHTA']
    useful_data['3.1.2'] = dvhh['C31212T']*dvhh['WEIGHTA']
    useful_data['3.1.3'] = dvhh['C31221T']*dvhh['WEIGHTA']
    useful_data['3.1.4'] = dvhh['C31222T']*dvhh['WEIGHTA']
    useful_data['3.1.5'] = dvhh['C31231T']*dvhh['WEIGHTA']
    useful_data['3.1.6'] = dvhh['C31232T']*dvhh['WEIGHTA']
    useful_data['3.1.7'] = dvhh['C31233T']*dvhh['WEIGHTA']
    useful_data['3.1.8'] = dvhh['C31234T']*dvhh['WEIGHTA']
    useful_data['3.1.9.1'] = dvhh['C31311T']*dvhh['WEIGHTA']
    useful_data['3.1.9.2'] = dvhh['C31312T']*dvhh['WEIGHTA']
    useful_data['3.1.9.3'] = dvhh['C31313T']*dvhh['WEIGHTA']
    useful_data['3.1.9.4'] = dvhh['C31315T']*dvhh['WEIGHTA']
    useful_data['3.1.10'] = (dvhh['C31111T']+dvhh['C31314T']+dvhh['C31411T'])*dvhh['WEIGHTA']
    useful_data['3.1.11.1'] = dvhh['C31412T']*dvhh['WEIGHTA']
    useful_data['3.1.11.2'] = dvhh['C31413T']*dvhh['WEIGHTA']
    useful_data['3.2.1'] = dvhh['C32111T']*dvhh['WEIGHTA']
    useful_data['3.2.2'] = dvhh['C32121T']*dvhh['WEIGHTA']
    useful_data['3.2.3'] = dvhh['C32131T']*dvhh['WEIGHTA']
    useful_data['3.2.4'] = dvhh['C32211T']*dvhh['WEIGHTA']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211T'])*dvhh['WEIGHTA'] #actual rentals
    useful_data['4.1.2'] = dvhh['A114']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['WEIGHTA']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212C'])*dvhh['WEIGHTA']
    useful_data['4.2.3'] = dvhh['C43111T']*dvhh['WEIGHTA']
    useful_data['4.2.4'] = dvhh['C43112T']*dvhh['WEIGHTA']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053P']+dvhh['B056P'])*dvhh['WEIGHTA']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['WEIGHTA']
    useful_data['4.3.3'] = dvhh['C44211T']*dvhh['WEIGHTA']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250T']+dvhh['C45112T']+dvhh['B222'])*dvhh['WEIGHTA']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249T']+dvhh['B221']+dvhh['C45212T']+dvhh['C45222T'])*dvhh['WEIGHTA']
    useful_data['4.4.3.1'] = dvhh['C45411T']*dvhh['WEIGHTA']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['WEIGHTA']
    useful_data['4.4.3.3'] = (dvhh['C45312T']+dvhh['C45412T']+dvhh['C45511T'])*dvhh['WEIGHTA']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111C'])*dvhh['WEIGHTA']
    useful_data['5.1.1.2'] = dvhh['C51113T']*dvhh['WEIGHTA']
    useful_data['5.1.1.3'] = dvhh['C51114T']*dvhh['WEIGHTA']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211C'])*dvhh['WEIGHTA']
    useful_data['5.1.2.2'] = dvhh['C51212T']*dvhh['WEIGHTA']
    useful_data['5.2.1'] = dvhh['C52111T']*dvhh['WEIGHTA']
    useful_data['5.2.2'] = dvhh['C52112T']*dvhh['WEIGHTA']
    useful_data['5.3.1'] = dvhh['C53131T']*dvhh['WEIGHTA']
    useful_data['5.3.2'] = dvhh['C53132T']*dvhh['WEIGHTA']
    useful_data['5.3.3'] = dvhh['C53121T']*dvhh['WEIGHTA']
    useful_data['5.3.4'] = dvhh['C53111T']*dvhh['WEIGHTA']
    useful_data['5.3.5'] = (dvhh['C53122T']+dvhh['C53133T']+dvhh['C53141T']+dvhh['C53151T']+dvhh['C53161T'])*dvhh['WEIGHTA']
    useful_data['5.3.6'] = dvhh['C53171T']*dvhh['WEIGHTA']
    useful_data['5.3.7'] = dvhh['C53211T']*dvhh['WEIGHTA']
    useful_data['5.3.8'] = (dvhh['C53311T']+dvhh['C53312T']+dvhh['C53313T'])*dvhh['WEIGHTA']
    useful_data['5.3.9'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['5.4.1'] = (dvhh['C54111T']+dvhh['C54121T'])*dvhh['WEIGHTA']
    useful_data['5.4.2'] = dvhh['C54131T']*dvhh['WEIGHTA']
    useful_data['5.4.3'] = dvhh['C54141T']*dvhh['WEIGHTA']
    useful_data['5.4.4'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['5.5.1'] = dvhh['C55111T']*dvhh['WEIGHTA']
    useful_data['5.5.2'] = (dvhh['C55112T']+dvhh['C55213T'])*dvhh['WEIGHTA']
    useful_data['5.5.3'] = dvhh['C55211T']*dvhh['WEIGHTA']
    useful_data['5.5.4'] = dvhh['C55212T']*dvhh['WEIGHTA']
    useful_data['5.5.5'] = dvhh['C55214T']*dvhh['WEIGHTA']
    useful_data['5.6.1.1'] = dvhh['C56111T']*dvhh['WEIGHTA']
    useful_data['5.6.1.2'] = dvhh['C56112T']*dvhh['WEIGHTA']
    useful_data['5.6.2.1'] = dvhh['C56121T']*dvhh['WEIGHTA']
    useful_data['5.6.2.2'] = dvhh['C56122T']*dvhh['WEIGHTA']
    useful_data['5.6.2.3'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['5.6.2.4'] = (dvhh['C56124T']+dvhh['C56125T'])*dvhh['WEIGHTA']
    useful_data['5.6.3.1'] = dvhh['C56211T']*dvhh['WEIGHTA']
    useful_data['5.6.3.2'] = (dvhh['C56221T']+dvhh['C56222T'])*dvhh['WEIGHTA']
    useful_data['5.6.3.3'] = (dvhh['C51311T'])*dvhh['WEIGHTA']
    useful_data['6.1.1.1'] = dvhh['C61111T']*dvhh['WEIGHTA']
    useful_data['6.1.1.2'] = dvhh['C61112T']*dvhh['WEIGHTA']
    useful_data['6.1.1.3'] = dvhh['C61211T']*dvhh['WEIGHTA']
    useful_data['6.1.1.4'] = dvhh['C61313T']*dvhh['WEIGHTA']
    useful_data['6.1.2.1'] = dvhh['C61311T']*dvhh['WEIGHTA']
    useful_data['6.1.2.2'] = dvhh['C61312T']*dvhh['WEIGHTA']
    useful_data['6.2.1.1'] = (dvhh['C62111T']+dvhh['C62113T']+dvhh['C62321T']+dvhh['C62211T'])*dvhh['WEIGHTA']
    useful_data['6.2.1.2'] = (dvhh['C62112T']+dvhh['C62114T']+dvhh['C62212T']+dvhh['C62322T'])*dvhh['WEIGHTA']
    useful_data['6.2.1.3'] = (dvhh['C62311T']+dvhh['C62331T'])*dvhh['WEIGHTA']
    useful_data['6.2.2'] = dvhh['C63111T']*dvhh['WEIGHTA']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111C'])*dvhh['WEIGHTA']
    useful_data['7.1.1.2'] = dvhh['C71112T']*dvhh['WEIGHTA']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121C'])*dvhh['WEIGHTA']
    useful_data['7.1.2.2'] = dvhh['C71122T']*dvhh['WEIGHTA']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211C'])*dvhh['WEIGHTA']
    useful_data['7.1.3.2'] = dvhh['C71212T']*dvhh['WEIGHTA']
    useful_data['7.1.3.3'] = (dvhh['C71311T']+dvhh['C71411T'])*dvhh['WEIGHTA']
    useful_data['7.2.1.1'] = dvhh['C72111T']*dvhh['WEIGHTA']
    useful_data['7.2.1.2'] = dvhh['C72112T']*dvhh['WEIGHTA']
    useful_data['7.2.1.3'] = dvhh['C72113T']*dvhh['WEIGHTA']
    useful_data['7.2.1.4'] = dvhh['C72115T']*dvhh['WEIGHTA']
    useful_data['7.2.2.1'] = dvhh['C72211T']*dvhh['WEIGHTA']
    useful_data['7.2.2.2'] = dvhh['C72212T']*dvhh['WEIGHTA']
    useful_data['7.2.2.3'] = dvhh['C72213T']*dvhh['WEIGHTA']
    useful_data['7.2.3.1'] = (dvhh['C72311C']+dvhh['B249']+dvhh['B250'])*dvhh['WEIGHTA']
    useful_data['7.2.3.2'] = (dvhh['C72312C']+dvhh['B252'])*dvhh['WEIGHTA']
    useful_data['7.2.4.1'] = dvhh['C72313T']*dvhh['WEIGHTA']
    useful_data['7.2.4.2'] = (dvhh['C72314T']+dvhh['C72412T'])*dvhh['WEIGHTA']
    useful_data['7.2.4.3'] = dvhh['C72411T']*dvhh['WEIGHTA']
    useful_data['7.2.4.4'] = dvhh['C72413T']*dvhh['WEIGHTA']
    useful_data['7.2.4.5'] = dvhh['C72414T']*dvhh['WEIGHTA']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['WEIGHTA']
    useful_data['7.3.1.2'] = dvhh['C73112T']*dvhh['WEIGHTA']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['WEIGHTA']
    useful_data['7.3.2.2'] = dvhh['C73212T']*dvhh['WEIGHTA']
    useful_data['7.3.3.1'] = dvhh['C73512T']*dvhh['WEIGHTA']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['WEIGHTA']
    useful_data['7.3.4.1'] = (dvhh['C73311T']+dvhh['B480'])*dvhh['WEIGHTA']
    useful_data['7.3.4.2'] = (dvhh['C73312T']+dvhh['B481'])*dvhh['WEIGHTA']
    useful_data['7.3.4.3'] = dvhh['C73513T']*dvhh['WEIGHTA']
    useful_data['7.3.4.4'] = dvhh['C73213T']*dvhh['WEIGHTA']
    useful_data['7.3.4.5'] = (dvhh['C73214T']+dvhh['C73611T'])*dvhh['WEIGHTA']
    useful_data['7.3.4.6'] = dvhh['C72414T']*dvhh['WEIGHTA']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['WEIGHTA']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411T'])*dvhh['WEIGHTA']
    useful_data['8.1'] = dvhh['C81111T']*dvhh['WEIGHTA']
    useful_data['8.2.1'] = dvhh['C82111T']*dvhh['WEIGHTA']
    useful_data['8.2.2'] = dvhh['C82112T']*dvhh['WEIGHTA']
    useful_data['8.2.3'] = dvhh['C82113T']*dvhh['WEIGHTA']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111C']+dvhh['C83115T'])*dvhh['WEIGHTA']
    useful_data['8.3.2'] = dvhh['C83112T']*dvhh['WEIGHTA']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113C'])*dvhh['WEIGHTA']
    useful_data['8.3.4'] = dvhh['C83114T']*dvhh['WEIGHTA']
    useful_data['8.4'] = dvhh['C94245T']*dvhh['WEIGHTA']
    useful_data['9.1.1.1'] = (dvhh['C91111T']+dvhh['C91112T'])*dvhh['WEIGHTA']
    useful_data['9.1.1.2'] = (dvhh['C91113T']+dvhh['C91411T'])*dvhh['WEIGHTA']
    useful_data['9.1.2.1'] = (dvhh['C91121T']+dvhh['C91125T'])*dvhh['WEIGHTA']
    useful_data['9.1.2.2'] = (dvhh['C91122T']+dvhh['C91123T'])*dvhh['WEIGHTA']
    useful_data['9.1.2.3'] = dvhh['C91127T']*dvhh['WEIGHTA']
    useful_data['9.1.2.4'] = dvhh['C91124T']*dvhh['WEIGHTA']
    useful_data['9.1.2.5'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['9.1.2.6'] = dvhh['C91412T']*dvhh['WEIGHTA']
    useful_data['9.1.2.7'] = dvhh['C91311T']*dvhh['WEIGHTA']
    useful_data['9.1.2.8'] = dvhh['C91126T']*dvhh['WEIGHTA']
    useful_data['9.1.2.9'] = dvhh['C91511T']*dvhh['WEIGHTA']
    useful_data['9.1.3.1'] = dvhh['C91211T']*dvhh['WEIGHTA']
    useful_data['9.1.3.2'] = dvhh['C91413T']*dvhh['WEIGHTA']
    useful_data['9.1.3.3'] = dvhh['C91221T']*dvhh['WEIGHTA']
    useful_data['9.2.1'] = dvhh['C92111T']*dvhh['WEIGHTA']
    useful_data['9.2.2'] = dvhh['C92112T']*dvhh['WEIGHTA']
    useful_data['9.2.3'] = dvhh['C92117T']*dvhh['WEIGHTA']
    useful_data['9.2.4'] = dvhh['C92211T']*dvhh['WEIGHTA']
    useful_data['9.2.5'] = dvhh['C92221T']*dvhh['WEIGHTA']
    useful_data['9.2.6'] = dvhh['C92311T']*dvhh['WEIGHTA']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113C']+dvhh['C92115C'])*dvhh['WEIGHTA']
    useful_data['9.2.8'] = (dvhh['C92114T']+dvhh['C92116T'])*dvhh['WEIGHTA']
    useful_data['9.3.1'] = (dvhh['C93111T']+dvhh['C93114T'])*dvhh['WEIGHTA']
    useful_data['9.3.2.1'] = dvhh['C93112T']*dvhh['WEIGHTA']
    useful_data['9.3.2.2'] = dvhh['C93113T']*dvhh['WEIGHTA']
    useful_data['9.3.3'] = dvhh['C93211T']*dvhh['WEIGHTA']
    useful_data['9.3.4.1'] = dvhh['C93212T']*dvhh['WEIGHTA']
    useful_data['9.3.4.2'] = dvhh['C93311T']*dvhh['WEIGHTA']
    useful_data['9.3.4.3'] = dvhh['C93312T']*dvhh['WEIGHTA']
    useful_data['9.3.4.4'] = dvhh['C93313T']*dvhh['WEIGHTA']
    useful_data['9.3.5.1'] = dvhh['C93411T']*dvhh['WEIGHTA']
    useful_data['9.3.5.2'] = dvhh['C93412T']*dvhh['WEIGHTA']
    useful_data['9.3.5.3'] = dvhh['C93511T']*dvhh['WEIGHTA']
    useful_data['9.4.1.1'] = dvhh['C94111T']*dvhh['WEIGHTA']
    useful_data['9.4.1.2'] = dvhh['C94112T']*dvhh['WEIGHTA']
    useful_data['9.4.1.3'] = dvhh['C94113T']*dvhh['WEIGHTA']
    useful_data['9.4.1.4'] = (dvhh['C94114C']+dvhh['B162'])*dvhh['WEIGHTA']
    useful_data['9.4.1.5'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['9.4.2.1'] = dvhh['C94211T']*dvhh['WEIGHTA']
    useful_data['9.4.2.2'] = dvhh['C94212T']*dvhh['WEIGHTA']
    useful_data['9.4.2.3'] = dvhh['C94221T']*dvhh['WEIGHTA']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231C']+dvhh['C94232T'])*dvhh['WEIGHTA']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233C'])*dvhh['WEIGHTA']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237C'])*dvhh['WEIGHTA']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235C'])*dvhh['WEIGHTA']
    useful_data['9.4.3.5'] = dvhh['C94236T']*dvhh['WEIGHTA']
    useful_data['9.4.3.6'] = (dvhh['C94238T']+dvhh['C94239T'])*dvhh['WEIGHTA']
    useful_data['9.4.4.1'] = dvhh['C94241T']*dvhh['WEIGHTA']
    useful_data['9.4.4.2'] = dvhh['C94242T']*dvhh['WEIGHTA']
    useful_data['9.4.4.3'] = (dvhh['C94243T']+dvhh['C94244T'])*dvhh['WEIGHTA']
    useful_data['9.4.5'] = dvhh['C94246T']*dvhh['WEIGHTA']
    useful_data['9.4.6.1'] = dvhh['C94311T']*dvhh['WEIGHTA']
    useful_data['9.4.6.2'] = dvhh['C94312T']*dvhh['WEIGHTA']
    useful_data['9.4.6.3'] = (dvhh['C94313T']+dvhh['C94315T']+dvhh['C94316T']+dvhh['C94319T'])*dvhh['WEIGHTA']
    useful_data['9.4.6.4'] = dvhh['C94314T']*dvhh['WEIGHTA']
    useful_data['9.5.1'] = dvhh['C95111T']*dvhh['WEIGHTA']
    useful_data['9.5.2'] = dvhh['C95411T']*dvhh['WEIGHTA']
    useful_data['9.5.3'] = dvhh['C95311T']*dvhh['WEIGHTA']
    useful_data['9.5.4'] = dvhh['C95211T']*dvhh['WEIGHTA']
    useful_data['9.5.5'] = dvhh['C95212T']*dvhh['WEIGHTA']
    useful_data['10.1'] = (dvhh['B160']+dvhh['B164'])*dvhh['WEIGHTA']
    useful_data['10.2'] = (dvhh['CA1113T']+dvhh['CA2113T']+dvhh['CA3113T']+dvhh['CA4113T']+dvhh['CA5113T'])*dvhh['WEIGHTA']
    useful_data['11.1.1'] = (dvhh['CB1111T']+dvhh['CB1122T'])*dvhh['WEIGHTA']
    useful_data['11.1.2'] = (dvhh['CB111CT']+dvhh['CB111DT']+dvhh['CB111ET']+dvhh['CB111FT']+dvhh['CB111GT']+dvhh['CB111HT']+dvhh['CB111IT']+dvhh['CB111JT'])*dvhh['WEIGHTA']
    useful_data['11.1.3'] = (dvhh['CB1127T']+dvhh['CB1128T'])*dvhh['WEIGHTA']
    useful_data['11.1.4.1'] = (dvhh['CB1115T']+dvhh['CB111AC']+dvhh['CB1116T']+dvhh['CB111BC']+dvhh['CB1125T']+dvhh['CB1126T'])*dvhh['WEIGHTA']
    useful_data['11.1.4.2'] = (dvhh['CB1112T']+dvhh['CB1117C']+dvhh['CB1122T'])*dvhh['WEIGHTA']
    useful_data['11.1.4.3'] = (dvhh['CB1113T']+dvhh['CB1118C']+dvhh['CB1123T'])*dvhh['WEIGHTA']
    useful_data['11.1.4.4'] = (dvhh['CB1114T']+dvhh['CB1119C']+dvhh['CB1124T'])*dvhh['WEIGHTA']
    useful_data['11.1.5'] = dvhh['CB112BT']*dvhh['WEIGHTA']
    useful_data['11.1.6.1'] = dvhh['B260T']*dvhh['WEIGHTA']
    useful_data['11.1.6.2'] = dvhh['CB1213T']*dvhh['WEIGHTA']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111C']+dvhh['C96111C'])*dvhh['WEIGHTA']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112C']+dvhh['C96112C'])*dvhh['WEIGHTA']
    useful_data['11.2.3'] = dvhh['CB2114T']*dvhh['WEIGHTA']
    useful_data['12.1.1'] = dvhh['CC1111T']*dvhh['WEIGHTA']
    useful_data['12.1.2'] = dvhh['CC1311T']*dvhh['WEIGHTA']
    useful_data['12.1.3.1'] = dvhh['CC1312T']*dvhh['WEIGHTA']
    useful_data['12.1.3.2'] = dvhh['CC1313T']*dvhh['WEIGHTA']
    useful_data['12.1.3.3'] = dvhh['CC1314T']*dvhh['WEIGHTA']
    useful_data['12.1.4'] = dvhh['CC1317T']*dvhh['WEIGHTA']
    useful_data['12.1.5.1'] = dvhh['CC1315T']*dvhh['WEIGHTA']
    useful_data['12.1.5.2'] = dvhh['CC1316T']*dvhh['WEIGHTA']
    useful_data['12.1.5.3'] = dvhh['CC1211T']*dvhh['WEIGHTA']
    useful_data['12.2.1.1'] = (dvhh['CC3111T']+dvhh['CC3221T'])*dvhh['WEIGHTA']
    useful_data['12.2.1.2'] = dvhh['CC3211T']*dvhh['WEIGHTA']
    useful_data['12.2.1.3'] = dvhh['CC3224T']*dvhh['WEIGHTA']
    useful_data['12.2.2.1'] = dvhh['CC3222T']*dvhh['WEIGHTA']
    useful_data['12.2.2.2'] = dvhh['CC3223T']*dvhh['WEIGHTA']
    useful_data['12.2.2.3'] = dvhh['CC3112T']*dvhh['WEIGHTA']
    useful_data['12.3.1.1'] = dvhh['CC4111T']*dvhh['WEIGHTA']
    useful_data['12.3.1.2'] = dvhh['CC4112T']*dvhh['WEIGHTA']
    useful_data['12.3.1.3'] = dvhh['CC4121T']*dvhh['WEIGHTA']
    useful_data['12.3.1.4'] = dvhh['CC4122T']*dvhh['WEIGHTA']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['WEIGHTA']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['WEIGHTA']
    useful_data['12.4.1.3'] = dvhh['CC5213C']*dvhh['WEIGHTA']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311C'])*dvhh['WEIGHTA']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411C'])*dvhh['WEIGHTA']
    useful_data['12.4.3.2'] = dvhh['CC5412T']*dvhh['WEIGHTA']
    useful_data['12.4.4'] = dvhh['CC5413T']*dvhh['WEIGHTA']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['WEIGHTA']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['WEIGHTA']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['WEIGHTA']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['WEIGHTA']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['WEIGHTA']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211C'])*dvhh['WEIGHTA']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['WEIGHTA']
    useful_data['12.5.2.3'] = dvhh['CC6214T']*dvhh['WEIGHTA']
    useful_data['12.5.3.1'] = dvhh['CC7115T']*dvhh['WEIGHTA']
    useful_data['12.5.3.2'] = (dvhh['CC7111T']+dvhh['CC7112T'])*dvhh['WEIGHTA']
    useful_data['12.5.3.3'] = dvhh['CC7114T']*dvhh['WEIGHTA']
    useful_data['12.5.3.4'] = dvhh['CC7116T']*dvhh['WEIGHTA']
    useful_data['12.5.3.5'] = dvhh['CC7113T']*dvhh['WEIGHTA']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['WEIGHTA']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['WEIGHTA']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038P'])*dvhh['WEIGHTA']
    useful_data['13.2.1'] = dvhh['CK3111T']*dvhh['WEIGHTA']
    useful_data['13.2.2'] = dvhh['CK3112T']*dvhh['WEIGHTA']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['WEIGHTA']
    useful_data['13.3.1'] = dvhh['CK4111T']*dvhh['WEIGHTA']
    useful_data['13.3.2'] = dvhh['CK4112T']*dvhh['WEIGHTA']
    useful_data['13.4.1.1'] = (dvhh['CK5212T']+dvhh['CK5213T']+dvhh['CK5214T']+dvhh['CK5215T'])*dvhh['WEIGHTA']
    useful_data['13.4.1.2'] = dvhh['CK5216T']*dvhh['WEIGHTA']
    useful_data['13.4.2.1'] = (dvhh['CK5221T']+dvhh['CK5222T'])*dvhh['WEIGHTA']
    useful_data['13.4.2.2'] = dvhh['CK5223T']*dvhh['WEIGHTA']
    useful_data['13.4.2.3'] = (dvhh['B334H']+dvhh['CK5224C'])*dvhh['WEIGHTA']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['WEIGHTA']
    useful_data['13.4.3.1'] = dvhh['CK5315C']*dvhh['WEIGHTA']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['WEIGHTA']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111C'])*dvhh['WEIGHTA']
    useful_data['14.1.2'] = (dvhh['P071H']+dvhh['CK5116T'])*dvhh['WEIGHTA']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['WEIGHTA']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511C']+dvhh['B205']+dvhh['CC5312C'])*dvhh['WEIGHTA']
    useful_data['14.3.1'] = dvhh['P390']*dvhh['WEIGHTA']
    useful_data['14.3.2'] = (dvhh['B387H']+dvhh['CK5411C'])*dvhh['WEIGHTA']
    useful_data['14.3.3'] = dvhh['B391H']*dvhh['WEIGHTA']
    useful_data['14.3.4'] = dvhh['P068H']*dvhh['WEIGHTA']
    useful_data['14.3.5'] = dvhh['P073H']*dvhh['WEIGHTA']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['WEIGHTA']
    useful_data['14.3.7'] = dvhh['B390H']*-1*dvhh['WEIGHTA']
    useful_data['14.4.1'] = (dvhh['P388']+dvhh['CK5412C'])*dvhh['WEIGHTA']
    useful_data['14.4.2'] = dvhh['P029H']*dvhh['WEIGHTA']
    useful_data['14.5.1'] = dvhh['CK1211T']*dvhh['WEIGHTA']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['WEIGHTA']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['WEIGHTA']
    useful_data['14.5.4'] = dvhh['CK1314T']*dvhh['WEIGHTA']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['WEIGHTA']
    useful_data['14.5.6'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['14.5.7'] = dvhh['CK1315T']*dvhh['WEIGHTA']
    useful_data['14.5.8'] = dvhh['CK1411T']*dvhh['WEIGHTA']
    useful_data['14.6.1'] = dvhh['CK5111T']*dvhh['WEIGHTA']
    useful_data['14.6.2'] = dvhh['CK5113T']*dvhh['WEIGHTA']
    useful_data['14.6.3'] = dvhh['CK2111T']*dvhh['WEIGHTA']
    useful_data['14.7'] = dvhh['CK5316T']*dvhh['WEIGHTA']
    useful_data['14.8'] = (dvhh['C9431AT']+dvhh['C9431BT']+dvhh['C9431CT']+dvhh['C9431DT']+dvhh['C9431ET']+dvhh['C9431FT']+dvhh['C9431IT'])*dvhh['WEIGHTA']
    
    return useful_data

def make_2002(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['a121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 7:
            owned_prop[n] = 1
     
    person_data = df()
    person_data['person_no'] = dvper['person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = np.zeros(shape=np.size(dvper,0))
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['sexhrp']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['a049']
    useful_data['type of hhold'] = dvhh['a062']
    useful_data['category of dwelling'] = dvhh['a116']
    useful_data['tenure type'] = dvhh['a122']
    useful_data['GOR modified'] = dvhh['gorx']
    useful_data['OA class 1D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['a091']
    useful_data['rooms in accommodation'] = dvhh['a114']
    useful_data['1.1.1.1'] = dvhh['c11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['c11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['c11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['c11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['c11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['c11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['c11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['c11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['c11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['c11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['c11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['c11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['c11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['c11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['c11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['c11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['c11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['c11321t']+dvhh['c11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['c11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['c11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['c11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['c11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['c11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['c11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['c11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['c11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['c11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['c11521t']+dvhh['c11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['c11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['c11541t']+dvhh['c11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['c11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['c11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['c11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['c11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['c11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['c11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['c11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['c11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['c11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['c11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['c11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['c11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['c11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['c11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['c11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['c11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['c11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['c11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['c11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['c11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['c11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['c11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['c11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['c11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['c11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['c11921t']+dvhh['c11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['c12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['c12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['c12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['c12231t']+dvhh['c12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['c12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['c12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['c21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['c21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['c21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['c21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['c21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['c22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['c22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['c22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['c31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['c31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['c31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['c31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['c31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['c31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['c31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['c31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['c31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['c31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['c31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['c31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['c31111t']+dvhh['c31314t']+dvhh['c31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['c31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['c31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['c32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['c32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['c32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['c32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['b010']+dvhh['b020']+dvhh['c41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['b102']+dvhh['b104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['b107']+dvhh['b108']+dvhh['c43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['c43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['c43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['b050']+dvhh['b053p']+dvhh['b056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['b060']+dvhh['b159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['c44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['b175']+dvhh['p250t']+dvhh['c45112t']+dvhh['b222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['b018']+dvhh['b170']+dvhh['p249t']+dvhh['b221']+dvhh['c45212t']+dvhh['c45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['c45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['b017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['c45312t']+dvhh['c45412t']+dvhh['c45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['b270']+dvhh['c51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['c51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['c51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['b271']+dvhh['c51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['c51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['c52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['c52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['c53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['c53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['c53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['c53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['c53122t']+dvhh['c53133t']+dvhh['c53141t']+dvhh['c53151t']+dvhh['c53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['c53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['c53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['c53311t']+dvhh['c53312t']+dvhh['c53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['c53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['c54111t']+dvhh['c54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['c54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['c54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['c54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['c55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['c55112t']+dvhh['c55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['c55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['c55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['c55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['c56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['c56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['c56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['c56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['c56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['c56124t']+dvhh['c56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['c56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['c56221t']+dvhh['c56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['c56223t']+dvhh['c51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['c61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['c61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['c61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['c61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['c61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['c61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['c62111t']+dvhh['c62113t']+dvhh['c62321t']+dvhh['c62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['c62112t']+dvhh['c62114t']+dvhh['c62212t']+dvhh['c62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['c62311t']+dvhh['c62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['c63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['b244']+dvhh['c71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['c71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['b245']+dvhh['c71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['c71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['b247']+dvhh['c71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['c71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['c71311t']+dvhh['c71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['c72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['c72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['c72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['c72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['c72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['c72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['c72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['c72311c']+dvhh['b249']+dvhh['b250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['c72312c']+dvhh['b252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['c72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['c72314t']+dvhh['c72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['c72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['c72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['b218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['c73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['b217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['c73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['c73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['b216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['c73311t']+dvhh['b480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['c73312t']+dvhh['b481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['c73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['c73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['c73214t']+dvhh['c73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['b248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['b219']+dvhh['c73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['c81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['c82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['c82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['c82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['b166']+dvhh['c83111c']+dvhh['c83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['c83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['b1661']+dvhh['c83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['c83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['c94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['c91111t']+dvhh['c91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['c91113t']+dvhh['c91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['c91121t']+dvhh['c91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['c91122t']+dvhh['c91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['c91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['c91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = np.zeros(shape=np.size(dvhh,0))
    useful_data['9.1.2.6'] = dvhh['c91412t']*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['c91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['c91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['c91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['c91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['c91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['c91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['c92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['c92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['c92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['c92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['c92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['c92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['b2441']+dvhh['b2451']+dvhh['c92113c']+dvhh['c92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['c92114t']+dvhh['c92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['c93111t']+dvhh['c93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['c93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['c93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['c93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['c93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['c93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['c93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['c93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['c93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['c93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['c93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['c94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['c94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['c94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['c94114c']+dvhh['b162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['c94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['c94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['c94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['c94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['b181']+dvhh['c94231c']+dvhh['c94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['b192']+dvhh['c94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['b191']+dvhh['c94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['b193']+dvhh['c94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['c94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['c94238t']+dvhh['c94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['c94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['c94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['c94243t']+dvhh['c94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['c94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['c94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['c94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['c94313t']+dvhh['c94315t']+dvhh['c94316t']+dvhh['c94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['c94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['c95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['c95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['c95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['c95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['c95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['b1601']+dvhh['ca1111c']+dvhh['b1641']+dvhh['ca1112c']+dvhh['b1602']+dvhh['ca2111c']+dvhh['b1642']+dvhh['ca2112c']+dvhh['b1603']+dvhh['ca3111c']+dvhh['b1643']+dvhh['ca3112c']+dvhh['b1604']+dvhh['ca4111c']+dvhh['b1644']+dvhh['ca4112c']+dvhh['b1605']+dvhh['ca5111c']+dvhh['b1645']+dvhh['ca5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['ca1113t']+dvhh['ca2113t']+dvhh['ca3113t']+dvhh['ca4113t']+dvhh['ca5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['cb1111t']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['cb111ct']+dvhh['cb111dt']+dvhh['cb111et']+dvhh['cb111ft']+dvhh['cb111gt']+dvhh['cb111ht']+dvhh['cb111it']+dvhh['cb111jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['cb1127t']+dvhh['cb1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['cb1115t']+dvhh['cb111ac']+dvhh['cb1116t']+dvhh['cb111bc']+dvhh['cb1125t']+dvhh['cb1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['cb1112t']+dvhh['cb1117c']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['cb1113t']+dvhh['cb1118c']+dvhh['cb1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['cb1114t']+dvhh['cb1119c']+dvhh['cb1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['cb112bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['b260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['cb1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['b482']+dvhh['b484']+dvhh['cb2111c']+dvhh['c96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['b483']+dvhh['b485']+dvhh['cb2112c']+dvhh['c96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['cb2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['cc1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['cc1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['cc1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['cc1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['cc1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['cc1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['cc1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['cc1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['cc1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['cc3111t']+dvhh['cc3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['cc3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['cc3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['cc3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['cc3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['cc3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['cc4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['cc4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['cc4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['cc4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['b110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['b168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['cc5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['b229']+dvhh['cc5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['b188']+dvhh['cc5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['cc5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['cc5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['b273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['b280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['b281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['b282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['b283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['b1802']+dvhh['cc6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['b238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['cc6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['cc7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['cc7111t']+dvhh['cc7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['cc7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['cc7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['cc7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['b130']+dvhh['b150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['b208']+dvhh['b213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['b030']+dvhh['b038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['ck3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['ck3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['b187']-dvhh['b179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['ck4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['ck4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['ck5212t']+dvhh['ck5213t']+dvhh['ck5214t']+dvhh['ck5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['ck5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['ck5221t']+dvhh['ck5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['ck5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['b334h']+dvhh['ck5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['b265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['ck5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['b237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['b196']+dvhh['b197']+dvhh['b201']+dvhh['b202']+dvhh['b198']+dvhh['b199']+dvhh['cc5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['p071h']+dvhh['ck5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['b228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['b206']+dvhh['cc5511c']+dvhh['b205']+dvhh['cc5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['b387h']+dvhh['ck5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['b391h']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['p068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['p073h']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['p391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['b390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['p388']+dvhh['ck5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['p029h']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['ck1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['b200']+dvhh['b203']-dvhh['b150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['b101']+dvhh['b103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['ck1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['b105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['ck1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['ck1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['ck1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['ck5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['ck5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['ck2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['ck5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['c9431at']+dvhh['c9431bt']+dvhh['c9431ct']+dvhh['c9431dt']+dvhh['c9431et']+dvhh['c9431ft']+dvhh['c9431it'])*dvhh['weighta']

    return useful_data


def make_2003(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['a121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 7:
            owned_prop[n] = 1
  
    person_data = df()
    person_data['person_no'] = dvper['person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['p067']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['sexhrp']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['a049']
    useful_data['type of hhold'] = dvhh['a062']
    useful_data['category of dwelling'] = dvhh['a116']
    useful_data['tenure type'] = dvhh['a122']
    useful_data['GOR modified'] = dvhh['gorx']
    useful_data['OA class 1D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['a091']
    useful_data['rooms in accommodation'] = dvhh['a114']
    useful_data['1.1.1.1'] = dvhh['c11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['c11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['c11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['c11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['c11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['c11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['c11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['c11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['c11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['c11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['c11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['c11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['c11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['c11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['c11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['c11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['c11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['c11321t']+dvhh['c11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['c11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['c11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['c11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['c11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['c11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['c11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['c11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['c11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['c11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['c11521t']+dvhh['c11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['c11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['c11541t']+dvhh['c11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['c11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['c11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['c11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['c11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['c11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['c11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['c11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['c11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['c11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['c11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['c11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['c11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['c11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['c11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['c11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['c11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['c11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['c11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['c11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['c11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['c11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['c11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['c11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['c11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['c11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['c11921t']+dvhh['c11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['c12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['c12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['c12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['c12231t']+dvhh['c12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['c12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['c12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['c21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['c21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['c21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['c21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['c21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['c22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['c22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['c22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['c31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['c31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['c31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['c31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['c31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['c31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['c31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['c31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['c31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['c31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['c31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['c31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['c31111t']+dvhh['c31314t']+dvhh['c31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['c31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['c31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['c32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['c32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['c32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['c32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['b010']+dvhh['b020']+dvhh['c41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['b102']+dvhh['b104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['b107']+dvhh['b108']+dvhh['c43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['c43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['c43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['b050']+dvhh['b053p']+dvhh['b056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['b060']+dvhh['b159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['c44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['b175']+dvhh['p250t']+dvhh['c45112t']+dvhh['b222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['b018']+dvhh['b170']+dvhh['p249t']+dvhh['b221']+dvhh['c45212t']+dvhh['c45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['c45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['b017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['c45312t']+dvhh['c45412t']+dvhh['c45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['b270']+dvhh['c51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['c51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['c51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['b271']+dvhh['c51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['c51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['c52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['c52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['c53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['c53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['c53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['c53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['c53122t']+dvhh['c53133t']+dvhh['c53141t']+dvhh['c53151t']+dvhh['c53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['c53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['c53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['c53311t']+dvhh['c53312t']+dvhh['c53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['c53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['c54111t']+dvhh['c54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['c54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['c54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['c54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['c55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['c55112t']+dvhh['c55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['c55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['c55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['c55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['c56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['c56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['c56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['c56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['c56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['c56124t']+dvhh['c56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['c56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['c56221t']+dvhh['c56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['c56223t']+dvhh['c51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['c61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['c61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['c61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['c61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['c61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['c61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['c62111t']+dvhh['c62113t']+dvhh['c62321t']+dvhh['c62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['c62112t']+dvhh['c62114t']+dvhh['c62212t']+dvhh['c62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['c62311t']+dvhh['c62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['c63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['b244']+dvhh['c71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['c71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['b245']+dvhh['c71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['c71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['b247']+dvhh['c71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['c71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['c71311t']+dvhh['c71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['c72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['c72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['c72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['c72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['c72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['c72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['c72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['c72311c']+dvhh['b249']+dvhh['b250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['c72312c']+dvhh['b252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['c72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['c72314t']+dvhh['c72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['c72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['c72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['b218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['c73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['b217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['c73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['c73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['b216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['c73311t']+dvhh['b480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['c73312t']+dvhh['b481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['c73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['c73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['c73214t']+dvhh['c73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['b248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['b219']+dvhh['c73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['c81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['c82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['c82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['c82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['b166']+dvhh['c83111c']+dvhh['c83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['c83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['b1661']+dvhh['c83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['c83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['c94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['c91111t']+dvhh['c91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['c91113t']+dvhh['c91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['c91121t']+dvhh['c91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['c91122t']+dvhh['c91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['c91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['c91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['c91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = dvhh['c91412t']*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['c91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['c91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['c91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['c91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['c91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['c91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['c92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['c92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['c92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['c92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['c92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['c92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['b2441']+dvhh['b2451']+dvhh['c92113c']+dvhh['c92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['c92114t']+dvhh['c92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['c93111t']+dvhh['c93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['c93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['c93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['c93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['c93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['c93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['c93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['c93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['c93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['c93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['c93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['c94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['c94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['c94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['c94114c']+dvhh['b162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['c94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['c94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['c94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['c94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['b181']+dvhh['c94231c']+dvhh['c94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['b192']+dvhh['c94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['b191']+dvhh['c94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['b193']+dvhh['c94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['c94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['c94238t']+dvhh['c94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['c94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['c94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['c94243t']+dvhh['c94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['c94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['c94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['c94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['c94313t']+dvhh['c94315t']+dvhh['c94316t']+dvhh['c94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['c94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['c95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['c95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['c95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['c95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['c95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['b1601']+dvhh['ca1111c']+dvhh['b1641']+dvhh['ca1112c']+dvhh['b1602']+dvhh['ca2111c']+dvhh['b1642']+dvhh['ca2112c']+dvhh['b1603']+dvhh['ca3111c']+dvhh['b1643']+dvhh['ca3112c']+dvhh['b1604']+dvhh['ca4111c']+dvhh['b1644']+dvhh['ca4112c']+dvhh['b1605']+dvhh['ca5111c']+dvhh['b1645']+dvhh['ca5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['ca1113t']+dvhh['ca2113t']+dvhh['ca3113t']+dvhh['ca4113t']+dvhh['ca5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['cb1111t']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['cb111ct']+dvhh['cb111dt']+dvhh['cb111et']+dvhh['cb111ft']+dvhh['cb111gt']+dvhh['cb111ht']+dvhh['cb111it']+dvhh['cb111jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['cb1127t']+dvhh['cb1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['cb1115t']+dvhh['cb111ac']+dvhh['cb1116t']+dvhh['cb111bc']+dvhh['cb1125t']+dvhh['cb1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['cb1112t']+dvhh['cb1117c']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['cb1113t']+dvhh['cb1118c']+dvhh['cb1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['cb1114t']+dvhh['cb1119c']+dvhh['cb1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['cb112bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['b260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['cb1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['b482']+dvhh['b484']+dvhh['cb2111c']+dvhh['c96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['b483']+dvhh['b485']+dvhh['cb2112c']+dvhh['c96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['cb2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['cc1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['cc1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['cc1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['cc1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['cc1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['cc1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['cc1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['cc1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['cc1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['cc3111t']+dvhh['cc3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['cc3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['cc3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['cc3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['cc3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['cc3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['cc4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['cc4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['cc4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['cc4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['b110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['b168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['cc5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['b229']+dvhh['cc5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['b188']+dvhh['cc5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['cc5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['cc5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['b273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['b280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['b281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['b282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['b283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['b1802']+dvhh['cc6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['b238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['cc6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['cc7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['cc7111t']+dvhh['cc7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['cc7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['cc7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['cc7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['b130']+dvhh['b150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['b208']+dvhh['b213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['b030']+dvhh['b038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['ck3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['ck3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['b187']-dvhh['b179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['ck4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['ck4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['ck5212t']+dvhh['ck5213t']+dvhh['ck5214t']+dvhh['ck5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['ck5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['ck5221t']+dvhh['ck5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['ck5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['b334h']+dvhh['ck5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['b265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['ck5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['b237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['b196']+dvhh['b197']+dvhh['b201']+dvhh['b202']+dvhh['b198']+dvhh['b199']+dvhh['cc5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['p071h']+dvhh['ck5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['b228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['b206']+dvhh['cc5511c']+dvhh['b205']+dvhh['cc5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['b387h']+dvhh['ck5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['b391h']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['p068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['p073h']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['p391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['b390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['p388']+dvhh['ck5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['p029h']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['ck1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['b200']+dvhh['b203']-dvhh['b150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['b101']+dvhh['b103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['ck1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['b105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['ck1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['ck1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['ck1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['ck5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['ck5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['ck2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['ck5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['c9431at']+dvhh['c9431bt']+dvhh['c9431ct']+dvhh['c9431dt']+dvhh['c9431et']+dvhh['c9431ft']+dvhh['c9431it'])*dvhh['weighta']

    
    return useful_data


def make_2004(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['a121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['a121'].iloc[n] == 7:
            owned_prop[n] = 1
    
    person_data = df()
    person_data['person_no'] = dvper['person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['p067']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['sexhrp']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['a049']
    useful_data['type of hhold'] = dvhh['a062']
    useful_data['category of dwelling'] = dvhh['a116']
    useful_data['tenure type'] = dvhh['a122']
    useful_data['GOR modified'] = dvhh['gorx']
    useful_data['OA class 1D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['a091']
    useful_data['rooms in accommodation'] = dvhh['a114']
    useful_data['1.1.1.1'] = dvhh['c11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['c11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['c11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['c11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['c11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['c11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['c11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['c11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['c11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['c11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['c11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['c11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['c11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['c11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['c11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['c11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['c11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['c11321t']+dvhh['c11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['c11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['c11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['c11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['c11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['c11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['c11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['c11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['c11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['c11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['c11521t']+dvhh['c11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['c11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['c11541t']+dvhh['c11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['c11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['c11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['c11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['c11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['c11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['c11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['c11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['c11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['c11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['c11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['c11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['c11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['c11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['c11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['c11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['c11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['c11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['c11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['c11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['c11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['c11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['c11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['c11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['c11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['c11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['c11921t']+dvhh['c11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['c12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['c12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['c12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['c12231t']+dvhh['c12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['c12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['c12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['c21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['c21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['c21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['c21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['c21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['c21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['c22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['c22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['c22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['c31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['c31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['c31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['c31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['c31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['c31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['c31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['c31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['c31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['c31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['c31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['c31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['c31111t']+dvhh['c31314t']+dvhh['c31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['c31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['c31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['c32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['c32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['c32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['c32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['b010']+dvhh['b020']+dvhh['c41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['b102']+dvhh['b104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['b107']+dvhh['b108']+dvhh['c43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['c43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['c43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['b050']+dvhh['b053p']+dvhh['b056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['b060']+dvhh['b159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['c44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['b175']+dvhh['p250t']+dvhh['c45112t']+dvhh['b222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['b018']+dvhh['b170']+dvhh['p249t']+dvhh['b221']+dvhh['c45212t']+dvhh['c45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['c45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['b017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['c45312t']+dvhh['c45412t']+dvhh['c45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['b270']+dvhh['c51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['c51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['c51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['b271']+dvhh['c51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['c51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['c52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['c52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['c53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['c53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['c53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['c53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['c53122t']+dvhh['c53133t']+dvhh['c53141t']+dvhh['c53151t']+dvhh['c53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['c53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['c53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['c53311t']+dvhh['c53312t']+dvhh['c53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['c53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['c54111t']+dvhh['c54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['c54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['c54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['c54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['c55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['c55112t']+dvhh['c55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['c55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['c55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['c55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['c56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['c56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['c56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['c56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['c56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['c56124t']+dvhh['c56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['c56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['c56221t']+dvhh['c56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['c56223t']+dvhh['c51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['c61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['c61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['c61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['c61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['c61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['c61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['c62111t']+dvhh['c62113t']+dvhh['c62321t']+dvhh['c62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['c62112t']+dvhh['c62114t']+dvhh['c62212t']+dvhh['c62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['c62311t']+dvhh['c62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['c63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['b244']+dvhh['c71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['c71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['b245']+dvhh['c71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['c71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['b247']+dvhh['c71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['c71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['c71311t']+dvhh['c71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['c72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['c72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['c72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['c72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['c72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['c72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['c72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['c72311c']+dvhh['b249']+dvhh['b250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['c72312c']+dvhh['b252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['c72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['c72314t']+dvhh['c72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['c72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['c72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['b218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['c73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['b217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['c73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['c73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['b216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['c73311t']+dvhh['b480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['c73312t']+dvhh['b481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['c73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['c73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['c73214t']+dvhh['c73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['c72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['b248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['b219']+dvhh['c73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['c81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['c82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['c82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['c82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['b166']+dvhh['c83111c']+dvhh['c83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['c83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['b1661']+dvhh['c83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['c83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['c94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['c91111t']+dvhh['c91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['c91113t']+dvhh['c91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['c91121t']+dvhh['c91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['c91122t']+dvhh['c91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['c91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['c91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['c91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = dvhh['c91412t']*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['c91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['c91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['c91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['c91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['c91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['c91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['c92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['c92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['c92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['c92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['c92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['c92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['b2441']+dvhh['b2451']+dvhh['c92113c']+dvhh['c92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['c92114t']+dvhh['c92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['c93111t']+dvhh['c93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['c93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['c93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['c93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['c93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['c93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['c93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['c93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['c93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['c93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['c93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['c94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['c94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['c94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['c94114c']+dvhh['b162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['c94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['c94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['c94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['c94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['b181']+dvhh['c94231c']+dvhh['c94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['b192']+dvhh['c94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['b191']+dvhh['c94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['b193']+dvhh['c94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['c94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['c94238t']+dvhh['c94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['c94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['c94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['c94243t']+dvhh['c94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['c94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['c94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['c94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['c94313t']+dvhh['c94315t']+dvhh['c94316t']+dvhh['c94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['c94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['c95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['c95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['c95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['c95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['c95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['b1601']+dvhh['ca1111c']+dvhh['b1641']+dvhh['ca1112c']+dvhh['b1602']+dvhh['ca2111c']+dvhh['b1642']+dvhh['ca2112c']+dvhh['b1603']+dvhh['ca3111c']+dvhh['b1643']+dvhh['ca3112c']+dvhh['b1604']+dvhh['ca4111c']+dvhh['b1644']+dvhh['ca4112c']+dvhh['b1605']+dvhh['ca5111c']+dvhh['b1645']+dvhh['ca5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['ca1113t']+dvhh['ca2113t']+dvhh['ca3113t']+dvhh['ca4113t']+dvhh['ca5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['cb1111t']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['cb111ct']+dvhh['cb111dt']+dvhh['cb111et']+dvhh['cb111ft']+dvhh['cb111gt']+dvhh['cb111ht']+dvhh['cb111it']+dvhh['cb111jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['cb1127t']+dvhh['cb1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['cb1115t']+dvhh['cb111ac']+dvhh['cb1116t']+dvhh['cb111bc']+dvhh['cb1125t']+dvhh['cb1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['cb1112t']+dvhh['cb1117c']+dvhh['cb1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['cb1113t']+dvhh['cb1118c']+dvhh['cb1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['cb1114t']+dvhh['cb1119c']+dvhh['cb1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['cb112bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['b260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['cb1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['b482']+dvhh['b484']+dvhh['cb2111c']+dvhh['c96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['b483']+dvhh['b485']+dvhh['cb2112c']+dvhh['c96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['cb2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['cc1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['cc1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['cc1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['cc1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['cc1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['cc1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['cc1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['cc1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['cc1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['cc3111t']+dvhh['cc3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['cc3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['cc3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['cc3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['cc3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['cc3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['cc4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['cc4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['cc4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['cc4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['b110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['b168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['cc5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['b229']+dvhh['cc5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['b188']+dvhh['cc5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['cc5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['cc5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['b273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['b280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['b281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['b282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['b283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['b1802']+dvhh['cc6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['b238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['cc6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['cc7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['cc7111t']+dvhh['cc7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['cc7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['cc7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['cc7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['b130']+dvhh['b150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['b208']+dvhh['b213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['b030']+dvhh['b038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['ck3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['ck3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['b187']-dvhh['b179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['ck4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['ck4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['ck5212t']+dvhh['ck5213t']+dvhh['ck5214t']+dvhh['ck5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['ck5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['ck5221t']+dvhh['ck5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['ck5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['b334h']+dvhh['ck5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['b265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['ck5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['b237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['b196']+dvhh['b197']+dvhh['b201']+dvhh['b202']+dvhh['b198']+dvhh['b199']+dvhh['cc5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['p071h']+dvhh['ck5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['b228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['b206']+dvhh['cc5511c']+dvhh['b205']+dvhh['cc5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['b387h']+dvhh['ck5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['b391h']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['p068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['p073h']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['p391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['b390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['p388']+dvhh['ck5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['p029h']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['ck1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['b200']+dvhh['b203']-dvhh['b150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['b101']+dvhh['b103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['ck1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['b105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['ck1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['ck1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['ck1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['ck5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['ck5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['ck2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['ck5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['c9431at']+dvhh['c9431bt']+dvhh['c9431ct']+dvhh['c9431dt']+dvhh['c9431et']+dvhh['c9431ft']+dvhh['c9431it'])*dvhh['weighta']
        
    return useful_data


def make_2005(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] = np.zeros(shape = [len(dvhh)])
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B221']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['P390']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387h']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391h']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073h']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029h']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2006(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
  
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] = np.zeros(shape=[len(dvhh)])
    useful_data['OA class 2D'] = np.zeros(shape=len(dvhh))
    useful_data['OA class 3D'] = np.zeros(shape=len(dvhh))
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B221']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2007(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
        person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B221']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2008(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['A012p']
    person_data['ethnicity partner hrp'] = dvper['A013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B222'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B221']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2009(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
        person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['A012p']
    person_data['ethnicity partner hrp'] = dvper['A013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B224'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B223']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = (dvhh['B208']+dvhh['B213'])*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B201']+dvhh['B202']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2010(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
    
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B224'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B223']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B196']+dvhh['B197']+dvhh['B2011']+dvhh['B198']+dvhh['B199']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2011(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['A012p']
    person_data['ethnicity partner hrp'] = dvper['A013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B224'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B223']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B2011']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2012(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
        person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B175']+dvhh['P250t']+dvhh['C45112t']+dvhh['B224'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B018']+dvhh['B170']+dvhh['P249t']+dvhh['B223']+dvhh['C45212t']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['C94245t']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B2011']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B150'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2013(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t']+dvhh['B491']+dvhh['B2241'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B492']+dvhh['B2231']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['B1981']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2014(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
        person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t']+dvhh['B491']+dvhh['B2241'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B492']+dvhh['B2231']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['B1981']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2015(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)
    
    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
        person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] = dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['B1981']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data


def make_2016(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)

    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['B1981']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data

def make_2017(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)

    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['B1981']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data

def make_2018(file1,file2):
    
    dvhh = pd.read_csv(file1, sep='\t', index_col=0)
    dvper = pd.read_csv(file2, sep='\t', index_col=0)

    owned_prop = np.zeros(shape = len(dvhh))
    for n in range (1,len(dvhh)):
        if dvhh['A121'].iloc[n] == 5:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 6:
            owned_prop[n] = 1
        if dvhh['A121'].iloc[n] == 7:
            owned_prop[n] = 1
   
    person_data = df()
    person_data['person_no'] = dvper['Person']
    person_data['ethnicity_hrp'] = dvper['a012p']
    person_data['ethnicity partner hrp'] = dvper['a013p']
    person_data['income tax'] = dvper['P067p']
    
    useful_data = df()
    
    useful_data['weight'] = dvhh['weighta']
    useful_data['age HRP'] = dvhh['p396p']
    useful_data['sex HRP'] = dvhh['SexHRP']
    
    temp = useful_data.join(person_data, how = 'inner')
    temp = temp.convert_objects(convert_numeric=True).fillna(0)
    temp2 = temp.groupby(level=0)['ethnicity_hrp'].sum()
    temp3 = temp.groupby(level=0)['income tax'].sum()
    
    useful_data['ethnicity HRP'] = temp2
    useful_data['no people'] = dvhh['A049']
    useful_data['type of hhold'] = dvhh['A062']
    useful_data['category of dwelling'] = dvhh['A116']
    useful_data['tenure type'] = dvhh['A122']
    useful_data['GOR modified'] = dvhh['Gorx']
    useful_data['OA class 1D'] =  dvhh['OAC1D']
    useful_data['OA class 2D'] =  dvhh['OAC2D']
    useful_data['OA class 3D'] =  dvhh['OAC3D']
    useful_data['Income anonymised'] = dvhh['incanon']
    useful_data['Income tax'] = temp3
    useful_data['Socio-ec HRP'] = dvhh['A091']
    useful_data['rooms in accommodation'] = dvhh['a114p']
    useful_data['1.1.1.1'] = dvhh['C11111t']*dvhh['weighta']
    useful_data['1.1.1.2'] = dvhh['C11121t']*dvhh['weighta']
    useful_data['1.1.1.3'] = dvhh['C11151t']*dvhh['weighta']
    useful_data['1.1.2'] = dvhh['C11131t']*dvhh['weighta']
    useful_data['1.1.3.1'] = dvhh['C11122t']*dvhh['weighta']
    useful_data['1.1.3.2'] = dvhh['C11141t']*dvhh['weighta']
    useful_data['1.1.4'] = dvhh['C11142t']*dvhh['weighta']
    useful_data['1.1.5'] = dvhh['C11211t']*dvhh['weighta']
    useful_data['1.1.6'] = dvhh['C11221t']*dvhh['weighta']
    useful_data['1.1.7'] = dvhh['C11231t']*dvhh['weighta']
    useful_data['1.1.8'] = dvhh['C11241t']*dvhh['weighta']
    useful_data['1.1.9'] = dvhh['C11252t']*dvhh['weighta']
    useful_data['1.1.10.1'] = dvhh['C11251t']*dvhh['weighta']
    useful_data['1.1.10.2'] = dvhh['C11253t']*dvhh['weighta']
    useful_data['1.1.10.3'] = dvhh['C11261t']*dvhh['weighta']
    useful_data['1.1.10.4'] = dvhh['C11271t']*dvhh['weighta']
    useful_data['1.1.11.1'] = dvhh['C11311t']*dvhh['weighta']
    useful_data['1.1.11.2'] = (dvhh['C11321t']+dvhh['C11331t'])*dvhh['weighta']
    useful_data['1.1.11.3'] = dvhh['C11341t']*dvhh['weighta']
    useful_data['1.1.12.1'] = dvhh['C11411t']*dvhh['weighta']
    useful_data['1.1.12.2'] = dvhh['C11421t']*dvhh['weighta']
    useful_data['1.1.12.3'] = dvhh['C11431t']*dvhh['weighta']
    useful_data['1.1.13'] = dvhh['C11451t']*dvhh['weighta']
    useful_data['1.1.14'] = dvhh['C11471t']*dvhh['weighta']
    useful_data['1.1.15.1'] = dvhh['C11461t']*dvhh['weighta']
    useful_data['1.1.15.2'] = dvhh['C11441t']*dvhh['weighta']
    useful_data['1.1.16'] = dvhh['C11511t']*dvhh['weighta']
    useful_data['1.1.17'] = (dvhh['C11521t']+dvhh['C11522t'])*dvhh['weighta']
    useful_data['1.1.18.1'] = dvhh['C11531t']*dvhh['weighta']
    useful_data['1.1.18.2'] = (dvhh['C11541t']+dvhh['C11551t'])*dvhh['weighta']
    useful_data['1.1.19.1'] = dvhh['C11611t']*dvhh['weighta']
    useful_data['1.1.19.2'] = dvhh['C11621t']*dvhh['weighta']
    useful_data['1.1.19.3'] = dvhh['C11631t']*dvhh['weighta']
    useful_data['1.1.19.4'] = dvhh['C11641t']*dvhh['weighta']
    useful_data['1.1.19.5'] = dvhh['C11651t']*dvhh['weighta']
    useful_data['1.1.19.6'] = dvhh['C11661t']*dvhh['weighta']
    useful_data['1.1.20'] = dvhh['C11671t']*dvhh['weighta']
    useful_data['1.1.21'] = dvhh['C11681t']*dvhh['weighta']
    useful_data['1.1.22'] = dvhh['C11691t']*dvhh['weighta']
    useful_data['1.1.23.1'] = dvhh['C11711t']*dvhh['weighta']
    useful_data['1.1.23.2'] = dvhh['C11721t']*dvhh['weighta']
    useful_data['1.1.23.3'] = dvhh['C11731t']*dvhh['weighta']
    useful_data['1.1.23.4'] = dvhh['C11741t']*dvhh['weighta']
    useful_data['1.1.24'] = dvhh['C11751t']*dvhh['weighta']
    useful_data['1.1.25'] = dvhh['C11761t']*dvhh['weighta']
    useful_data['1.1.26'] = dvhh['C11771t']*dvhh['weighta']
    useful_data['1.1.27'] = dvhh['C11781t']*dvhh['weighta']
    useful_data['1.1.28.1'] = dvhh['C11811t']*dvhh['weighta']
    useful_data['1.1.28.2'] = dvhh['C11861t']*dvhh['weighta']
    useful_data['1.1.29'] = dvhh['C11821t']*dvhh['weighta']
    useful_data['1.1.30'] = dvhh['C11831t']*dvhh['weighta']
    useful_data['1.1.31'] = dvhh['C11841t']*dvhh['weighta']
    useful_data['1.1.32'] = dvhh['C11851t']*dvhh['weighta']
    useful_data['1.1.33.1'] = dvhh['C11911t']*dvhh['weighta']
    useful_data['1.1.33.2'] = dvhh['C11931t']*dvhh['weighta']
    useful_data['1.1.33.3'] = (dvhh['C11921t']+dvhh['C11941t'])*dvhh['weighta']
    useful_data['1.2.1'] = dvhh['C12111t']*dvhh['weighta']
    useful_data['1.2.2'] = dvhh['C12121t']*dvhh['weighta']
    useful_data['1.2.3'] = dvhh['C12131t']*dvhh['weighta']
    useful_data['1.2.4'] = (dvhh['C12231t']+dvhh['C12241t'])*dvhh['weighta']
    useful_data['1.2.5'] = dvhh['C12211t']*dvhh['weighta']
    useful_data['1.2.6'] = dvhh['C12221t']*dvhh['weighta']
    useful_data['2.1.1'] = dvhh['C21111t']*dvhh['weighta']
    useful_data['2.1.2.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.2.2'] = dvhh['C21212t']*dvhh['weighta']
    useful_data['2.1.2.3'] = dvhh['C21221t']*dvhh['weighta']
    useful_data['2.1.3.1'] = dvhh['C21211t']*dvhh['weighta']
    useful_data['2.1.3.2'] = dvhh['C21213t']*dvhh['weighta']
    useful_data['2.1.4'] = dvhh['C21214t']*dvhh['weighta']
    useful_data['2.2.1'] = dvhh['C22111t']*dvhh['weighta']
    useful_data['2.2.2.1'] = dvhh['C22121t']*dvhh['weighta']
    useful_data['2.2.2.2'] = dvhh['C22131t']*dvhh['weighta']
    useful_data['3.1.1'] = dvhh['C31211t']*dvhh['weighta']
    useful_data['3.1.2'] = dvhh['C31212t']*dvhh['weighta']
    useful_data['3.1.3'] = dvhh['C31221t']*dvhh['weighta']
    useful_data['3.1.4'] = dvhh['C31222t']*dvhh['weighta']
    useful_data['3.1.5'] = dvhh['C31231t']*dvhh['weighta']
    useful_data['3.1.6'] = dvhh['C31232t']*dvhh['weighta']
    useful_data['3.1.7'] = dvhh['C31233t']*dvhh['weighta']
    useful_data['3.1.8'] = dvhh['C31234t']*dvhh['weighta']
    useful_data['3.1.9.1'] = dvhh['C31311t']*dvhh['weighta']
    useful_data['3.1.9.2'] = dvhh['C31312t']*dvhh['weighta']
    useful_data['3.1.9.3'] = dvhh['C31313t']*dvhh['weighta']
    useful_data['3.1.9.4'] = dvhh['C31315t']*dvhh['weighta']
    useful_data['3.1.10'] = (dvhh['C31111t']+dvhh['C31314t']+dvhh['C31411t'])*dvhh['weighta']
    useful_data['3.1.11.1'] = dvhh['C31412t']*dvhh['weighta']
    useful_data['3.1.11.2'] = dvhh['C31413t']*dvhh['weighta']
    useful_data['3.2.1'] = dvhh['C32111t']*dvhh['weighta']
    useful_data['3.2.2'] = dvhh['C32121t']*dvhh['weighta']
    useful_data['3.2.3'] = dvhh['C32131t']*dvhh['weighta']
    useful_data['3.2.4'] = dvhh['C32211t']*dvhh['weighta']
    useful_data['4.1.1'] =  (dvhh['B010']+dvhh['B020']+dvhh['C41211t'])*dvhh['weighta'] #actual rentals
    useful_data['4.1.2'] = dvhh['a114p']*owned_prop #imputed rentals = no of rooms times 1 if owner occupied
    useful_data['4.2.1'] = (dvhh['B102']+dvhh['B104'])*dvhh['weighta']
    useful_data['4.2.2'] = (dvhh['B107']+dvhh['B108']+dvhh['C43212c'])*dvhh['weighta']
    useful_data['4.2.3'] = dvhh['C43111t']*dvhh['weighta']
    useful_data['4.2.4'] = dvhh['C43112t']*dvhh['weighta']
    useful_data['4.3.1'] = (dvhh['B050']+dvhh['B053p']+dvhh['B056p'])*dvhh['weighta']
    useful_data['4.3.2'] = (dvhh['B060']+dvhh['B159'])*dvhh['weighta']
    useful_data['4.3.3'] = dvhh['C44211t']*dvhh['weighta']
    useful_data['4.4.1'] = (dvhh['B489']+dvhh['B227']+dvhh['B254']+dvhh['B234']+dvhh['C45112t'])*dvhh['weighta']
    useful_data['4.4.2'] = (dvhh['B490']+dvhh['B226']+dvhh['B255']+dvhh['B235']+dvhh['C45212t']+dvhh['B018']+dvhh['C45222t'])*dvhh['weighta']
    useful_data['4.4.3.1'] = dvhh['C45411t']*dvhh['weighta']
    useful_data['4.4.3.2'] = dvhh['B017']*dvhh['weighta']
    useful_data['4.4.3.3'] = (dvhh['C45312t']+dvhh['C45412t']+dvhh['C45511t'])*dvhh['weighta']
    useful_data['5.1.1.1'] = (dvhh['B270']+dvhh['C51111c'])*dvhh['weighta']
    useful_data['5.1.1.2'] = dvhh['C51113t']*dvhh['weighta']
    useful_data['5.1.1.3'] = dvhh['C51114t']*dvhh['weighta']
    useful_data['5.1.2.1'] = (dvhh['B271']+dvhh['C51211c'])*dvhh['weighta']
    useful_data['5.1.2.2'] = dvhh['C51212t']*dvhh['weighta']
    useful_data['5.2.1'] = dvhh['C52111t']*dvhh['weighta']
    useful_data['5.2.2'] = dvhh['C52112t']*dvhh['weighta']
    useful_data['5.3.1'] = dvhh['C53131t']*dvhh['weighta']
    useful_data['5.3.2'] = dvhh['C53132t']*dvhh['weighta']
    useful_data['5.3.3'] = dvhh['C53121t']*dvhh['weighta']
    useful_data['5.3.4'] = dvhh['C53111t']*dvhh['weighta']
    useful_data['5.3.5'] = (dvhh['C53122t']+dvhh['C53133t']+dvhh['C53141t']+dvhh['C53151t']+dvhh['C53161t'])*dvhh['weighta']
    useful_data['5.3.6'] = dvhh['C53171t']*dvhh['weighta']
    useful_data['5.3.7'] = dvhh['C53211t']*dvhh['weighta']
    useful_data['5.3.8'] = (dvhh['C53311t']+dvhh['C53312t']+dvhh['C53313t'])*dvhh['weighta']
    useful_data['5.3.9'] = dvhh['C53314t']*dvhh['weighta']
    useful_data['5.4.1'] = (dvhh['C54111t']+dvhh['C54121t'])*dvhh['weighta']
    useful_data['5.4.2'] = dvhh['C54131t']*dvhh['weighta']
    useful_data['5.4.3'] = dvhh['C54141t']*dvhh['weighta']
    useful_data['5.4.4'] = dvhh['C54132t']*dvhh['weighta']
    useful_data['5.5.1'] = dvhh['C55111t']*dvhh['weighta']
    useful_data['5.5.2'] = (dvhh['C55112t']+dvhh['C55213t'])*dvhh['weighta']
    useful_data['5.5.3'] = dvhh['C55211t']*dvhh['weighta']
    useful_data['5.5.4'] = dvhh['C55212t']*dvhh['weighta']
    useful_data['5.5.5'] = dvhh['C55214t']*dvhh['weighta']
    useful_data['5.6.1.1'] = dvhh['C56111t']*dvhh['weighta']
    useful_data['5.6.1.2'] = dvhh['C56112t']*dvhh['weighta']
    useful_data['5.6.2.1'] = dvhh['C56121t']*dvhh['weighta']
    useful_data['5.6.2.2'] = dvhh['C56122t']*dvhh['weighta']
    useful_data['5.6.2.3'] = dvhh['C56123t']*dvhh['weighta']
    useful_data['5.6.2.4'] = (dvhh['C56124t']+dvhh['C56125t'])*dvhh['weighta']
    useful_data['5.6.3.1'] = dvhh['C56211t']*dvhh['weighta']
    useful_data['5.6.3.2'] = (dvhh['C56221t']+dvhh['C56222t'])*dvhh['weighta']
    useful_data['5.6.3.3'] = (dvhh['C56223t']+dvhh['C51311t'])*dvhh['weighta']
    useful_data['6.1.1.1'] = dvhh['C61111t']*dvhh['weighta']
    useful_data['6.1.1.2'] = dvhh['C61112t']*dvhh['weighta']
    useful_data['6.1.1.3'] = dvhh['C61211t']*dvhh['weighta']
    useful_data['6.1.1.4'] = dvhh['C61313t']*dvhh['weighta']
    useful_data['6.1.2.1'] = dvhh['C61311t']*dvhh['weighta']
    useful_data['6.1.2.2'] = dvhh['C61312t']*dvhh['weighta']
    useful_data['6.2.1.1'] = (dvhh['C62111t']+dvhh['C62113t']+dvhh['C62321t']+dvhh['C62211t'])*dvhh['weighta']
    useful_data['6.2.1.2'] = (dvhh['C62112t']+dvhh['C62114t']+dvhh['C62212t']+dvhh['C62322t'])*dvhh['weighta']
    useful_data['6.2.1.3'] = (dvhh['C62311t']+dvhh['C62331t'])*dvhh['weighta']
    useful_data['6.2.2'] = dvhh['C63111t']*dvhh['weighta']
    useful_data['7.1.1.1'] = (dvhh['B244']+dvhh['C71111c'])*dvhh['weighta']
    useful_data['7.1.1.2'] = dvhh['C71112t']*dvhh['weighta']
    useful_data['7.1.2.1'] = (dvhh['B245']+dvhh['C71121c'])*dvhh['weighta']
    useful_data['7.1.2.2'] = dvhh['C71122t']*dvhh['weighta']
    useful_data['7.1.3.1'] = (dvhh['B247']+dvhh['C71211c'])*dvhh['weighta']
    useful_data['7.1.3.2'] = dvhh['C71212t']*dvhh['weighta']
    useful_data['7.1.3.3'] = (dvhh['C71311t']+dvhh['C71411t'])*dvhh['weighta']
    useful_data['7.2.1.1'] = dvhh['C72111t']*dvhh['weighta']
    useful_data['7.2.1.2'] = dvhh['C72112t']*dvhh['weighta']
    useful_data['7.2.1.3'] = dvhh['C72113t']*dvhh['weighta']
    useful_data['7.2.1.4'] = dvhh['C72115t']*dvhh['weighta']
    useful_data['7.2.2.1'] = dvhh['C72211t']*dvhh['weighta']
    useful_data['7.2.2.2'] = dvhh['C72212t']*dvhh['weighta']
    useful_data['7.2.2.3'] = dvhh['C72213t']*dvhh['weighta']
    useful_data['7.2.3.1'] = (dvhh['C72311c']+dvhh['B249']+dvhh['B250'])*dvhh['weighta']
    useful_data['7.2.3.2'] = (dvhh['C72312c']+dvhh['B252'])*dvhh['weighta']
    useful_data['7.2.4.1'] = dvhh['C72313t']*dvhh['weighta']
    useful_data['7.2.4.2'] = (dvhh['C72314t']+dvhh['C72412t'])*dvhh['weighta']
    useful_data['7.2.4.3'] = dvhh['C72411t']*dvhh['weighta']
    useful_data['7.2.4.4'] = dvhh['C72413t']*dvhh['weighta']
    useful_data['7.2.4.5'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.1.1'] = dvhh['B218']*dvhh['weighta']
    useful_data['7.3.1.2'] = dvhh['C73112t']*dvhh['weighta']
    useful_data['7.3.2.1'] = dvhh['B217']*dvhh['weighta']
    useful_data['7.3.2.2'] = dvhh['C73212t']*dvhh['weighta']
    useful_data['7.3.3.1'] = dvhh['C73512t']*dvhh['weighta']
    useful_data['7.3.3.2'] = dvhh['B216']*dvhh['weighta']
    useful_data['7.3.4.1'] = (dvhh['C73311t']+dvhh['B480']+dvhh['B487'])*dvhh['weighta']
    useful_data['7.3.4.2'] = (dvhh['C73312t']+dvhh['B481']+dvhh['B488'])*dvhh['weighta']
    useful_data['7.3.4.3'] = dvhh['C73513t']*dvhh['weighta']
    useful_data['7.3.4.4'] = dvhh['C73213t']*dvhh['weighta']
    useful_data['7.3.4.5'] = (dvhh['C73214t']+dvhh['C73611t'])*dvhh['weighta']
    useful_data['7.3.4.6'] = dvhh['C72414t']*dvhh['weighta']
    useful_data['7.3.4.7'] = dvhh['B248']*dvhh['weighta']
    useful_data['7.3.4.8'] = (dvhh['B219']+dvhh['C73411t'])*dvhh['weighta']
    useful_data['8.1'] = dvhh['C81111t']*dvhh['weighta']
    useful_data['8.2.1'] = dvhh['C82111t']*dvhh['weighta']
    useful_data['8.2.2'] = dvhh['C82112t']*dvhh['weighta']
    useful_data['8.2.3'] = dvhh['C82113t']*dvhh['weighta']
    useful_data['8.3.1'] = (dvhh['B166']+dvhh['C83111c']+dvhh['C83115t'])*dvhh['weighta']
    useful_data['8.3.2'] = dvhh['C83112t']*dvhh['weighta']
    useful_data['8.3.3'] = (dvhh['B1661']+dvhh['C83113c'])*dvhh['weighta']
    useful_data['8.3.4'] = dvhh['C83114t']*dvhh['weighta']
    useful_data['8.4'] = dvhh['B195']*dvhh['weighta']
    useful_data['9.1.1.1'] = (dvhh['C91111t']+dvhh['C91112t'])*dvhh['weighta']
    useful_data['9.1.1.2'] = (dvhh['C91113t']+dvhh['C91411t'])*dvhh['weighta']
    useful_data['9.1.2.1'] = (dvhh['C91121t']+dvhh['C91125t'])*dvhh['weighta']
    useful_data['9.1.2.2'] = (dvhh['C91122t']+dvhh['C91123t'])*dvhh['weighta']
    useful_data['9.1.2.3'] = dvhh['C91127t']*dvhh['weighta']
    useful_data['9.1.2.4'] = dvhh['C91124t']*dvhh['weighta']
    useful_data['9.1.2.5'] = dvhh['C91128t']*dvhh['weighta']
    useful_data['9.1.2.6'] = (dvhh['C91412t']+dvhh['C91414t'])*dvhh['weighta']
    useful_data['9.1.2.7'] = dvhh['C91311t']*dvhh['weighta']
    useful_data['9.1.2.8'] = dvhh['C91126t']*dvhh['weighta']
    useful_data['9.1.2.9'] = dvhh['C91511t']*dvhh['weighta']
    useful_data['9.1.3.1'] = dvhh['C91211t']*dvhh['weighta']
    useful_data['9.1.3.2'] = dvhh['C91413t']*dvhh['weighta']
    useful_data['9.1.3.3'] = dvhh['C91221t']*dvhh['weighta']
    useful_data['9.2.1'] = dvhh['C92111t']*dvhh['weighta']
    useful_data['9.2.2'] = dvhh['C92112t']*dvhh['weighta']
    useful_data['9.2.3'] = dvhh['C92117t']*dvhh['weighta']
    useful_data['9.2.4'] = dvhh['C92211t']*dvhh['weighta']
    useful_data['9.2.5'] = dvhh['C92221t']*dvhh['weighta']
    useful_data['9.2.6'] = dvhh['C92311t']*dvhh['weighta']
    useful_data['9.2.7'] = (dvhh['B2441']+dvhh['B2451']+dvhh['C92113c']+dvhh['C92115c'])*dvhh['weighta']
    useful_data['9.2.8'] = (dvhh['C92114t']+dvhh['C92116t'])*dvhh['weighta']
    useful_data['9.3.1'] = (dvhh['C93111t']+dvhh['C93114t'])*dvhh['weighta']
    useful_data['9.3.2.1'] = dvhh['C93112t']*dvhh['weighta']
    useful_data['9.3.2.2'] = dvhh['C93113t']*dvhh['weighta']
    useful_data['9.3.3'] = dvhh['C93211t']*dvhh['weighta']
    useful_data['9.3.4.1'] = dvhh['C93212t']*dvhh['weighta']
    useful_data['9.3.4.2'] = dvhh['C93311t']*dvhh['weighta']
    useful_data['9.3.4.3'] = dvhh['C93312t']*dvhh['weighta']
    useful_data['9.3.4.4'] = dvhh['C93313t']*dvhh['weighta']
    useful_data['9.3.5.1'] = dvhh['C93411t']*dvhh['weighta']
    useful_data['9.3.5.2'] = dvhh['C93412t']*dvhh['weighta']
    useful_data['9.3.5.3'] = dvhh['C93511t']*dvhh['weighta']
    useful_data['9.4.1.1'] = dvhh['C94111t']*dvhh['weighta']
    useful_data['9.4.1.2'] = dvhh['C94112t']*dvhh['weighta']
    useful_data['9.4.1.3'] = dvhh['C94113t']*dvhh['weighta']
    useful_data['9.4.1.4'] = (dvhh['C94114c']+dvhh['B162'])*dvhh['weighta']
    useful_data['9.4.1.5'] = dvhh['C94115t']*dvhh['weighta']
    useful_data['9.4.2.1'] = dvhh['C94211t']*dvhh['weighta']
    useful_data['9.4.2.2'] = dvhh['C94212t']*dvhh['weighta']
    useful_data['9.4.2.3'] = dvhh['C94221t']*dvhh['weighta']
    useful_data['9.4.3.1'] = (dvhh['B181']+dvhh['C94231c']+dvhh['C94232t'])*dvhh['weighta']
    useful_data['9.4.3.2'] = (dvhh['B192']+dvhh['C94233c'])*dvhh['weighta']
    useful_data['9.4.3.3'] = (dvhh['B191']+dvhh['C94237c'])*dvhh['weighta']
    useful_data['9.4.3.4'] = (dvhh['B193']+dvhh['C94235c'])*dvhh['weighta']
    useful_data['9.4.3.5'] = dvhh['C94236t']*dvhh['weighta']
    useful_data['9.4.3.6'] = (dvhh['C94238t']+dvhh['C94239t'])*dvhh['weighta']
    useful_data['9.4.4.1'] = dvhh['C94241t']*dvhh['weighta']
    useful_data['9.4.4.2'] = dvhh['C94242t']*dvhh['weighta']
    useful_data['9.4.4.3'] = (dvhh['C94243t']+dvhh['C94244t'])*dvhh['weighta']
    useful_data['9.4.5'] = dvhh['C94246t']*dvhh['weighta']
    useful_data['9.4.6.1'] = dvhh['C94311t']*dvhh['weighta']
    useful_data['9.4.6.2'] = dvhh['C94312t']*dvhh['weighta']
    useful_data['9.4.6.3'] = (dvhh['C94313t']+dvhh['C94315t']+dvhh['C94316t']+dvhh['C94319t'])*dvhh['weighta']
    useful_data['9.4.6.4'] = dvhh['C94314t']*dvhh['weighta']
    useful_data['9.5.1'] = dvhh['C95111t']*dvhh['weighta']
    useful_data['9.5.2'] = dvhh['C95411t']*dvhh['weighta']
    useful_data['9.5.3'] = dvhh['C95311t']*dvhh['weighta']
    useful_data['9.5.4'] = dvhh['C95211t']*dvhh['weighta']
    useful_data['9.5.5'] = dvhh['C95212t']*dvhh['weighta']
    useful_data['10.1'] = (dvhh['B1601']+dvhh['CA1111c']+dvhh['B1641']+dvhh['CA1112c']+dvhh['B1602']+dvhh['CA2111c']+dvhh['B1642']+dvhh['CA2112c']+dvhh['B1603']+dvhh['CA3111c']+dvhh['B1643']+dvhh['CA3112c']+dvhh['B1604']+dvhh['CA4111c']+dvhh['B1644']+dvhh['CA4112c']+dvhh['B1605']+dvhh['CA5111c']+dvhh['B1645']+dvhh['CA5112c'])*dvhh['weighta']
    useful_data['10.2'] = (dvhh['CA1113t']+dvhh['CA2113t']+dvhh['CA3113t']+dvhh['CA4113t']+dvhh['CA5113t'])*dvhh['weighta']
    useful_data['11.1.1'] = (dvhh['CB1111t']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.2'] = (dvhh['CB111Ct']+dvhh['CB111Dt']+dvhh['CB111Et']+dvhh['CB111Ft']+dvhh['CB111Gt']+dvhh['CB111Ht']+dvhh['CB111It']+dvhh['CB111Jt'])*dvhh['weighta']
    useful_data['11.1.3'] = (dvhh['CB1127t']+dvhh['CB1128t'])*dvhh['weighta']
    useful_data['11.1.4.1'] = (dvhh['CB1115t']+dvhh['CB111Ac']+dvhh['CB1116t']+dvhh['CB111Bc']+dvhh['CB1125t']+dvhh['CB1126t'])*dvhh['weighta']
    useful_data['11.1.4.2'] = (dvhh['CB1112t']+dvhh['CB1117c']+dvhh['CB1122t'])*dvhh['weighta']
    useful_data['11.1.4.3'] = (dvhh['CB1113t']+dvhh['CB1118c']+dvhh['CB1123t'])*dvhh['weighta']
    useful_data['11.1.4.4'] = (dvhh['CB1114t']+dvhh['CB1119c']+dvhh['CB1124t'])*dvhh['weighta']
    useful_data['11.1.5'] = dvhh['CB112Bt']*dvhh['weighta']
    useful_data['11.1.6.1'] = dvhh['B260t']*dvhh['weighta']
    useful_data['11.1.6.2'] = dvhh['CB1213t']*dvhh['weighta']
    useful_data['11.2.1'] = (dvhh['B482']+dvhh['B484']+dvhh['CB2111c']+dvhh['C96111c'])*dvhh['weighta']
    useful_data['11.2.2'] = (dvhh['B483']+dvhh['B485']+dvhh['CB2112c']+dvhh['C96112c'])*dvhh['weighta']
    useful_data['11.2.3'] = dvhh['CB2114t']*dvhh['weighta']
    useful_data['12.1.1'] = dvhh['CC1111t']*dvhh['weighta']
    useful_data['12.1.2'] = dvhh['CC1311t']*dvhh['weighta']
    useful_data['12.1.3.1'] = dvhh['CC1312t']*dvhh['weighta']
    useful_data['12.1.3.2'] = dvhh['CC1313t']*dvhh['weighta']
    useful_data['12.1.3.3'] = dvhh['CC1314t']*dvhh['weighta']
    useful_data['12.1.4'] = dvhh['CC1317t']*dvhh['weighta']
    useful_data['12.1.5.1'] = dvhh['CC1315t']*dvhh['weighta']
    useful_data['12.1.5.2'] = dvhh['CC1316t']*dvhh['weighta']
    useful_data['12.1.5.3'] = dvhh['CC1211t']*dvhh['weighta']
    useful_data['12.2.1.1'] = (dvhh['CC3111t']+dvhh['CC3221t'])*dvhh['weighta']
    useful_data['12.2.1.2'] = dvhh['CC3211t']*dvhh['weighta']
    useful_data['12.2.1.3'] = dvhh['CC3224t']*dvhh['weighta']
    useful_data['12.2.2.1'] = dvhh['CC3222t']*dvhh['weighta']
    useful_data['12.2.2.2'] = dvhh['CC3223t']*dvhh['weighta']
    useful_data['12.2.2.3'] = dvhh['CC3112t']*dvhh['weighta']
    useful_data['12.3.1.1'] = dvhh['CC4111t']*dvhh['weighta']
    useful_data['12.3.1.2'] = dvhh['CC4112t']*dvhh['weighta']
    useful_data['12.3.1.3'] = dvhh['CC4121t']*dvhh['weighta']
    useful_data['12.3.1.4'] = dvhh['CC4122t']*dvhh['weighta']
    useful_data['12.4.1.1'] = dvhh['B110']*dvhh['weighta']
    useful_data['12.4.1.2'] = dvhh['B168']*dvhh['weighta']
    useful_data['12.4.1.3'] = dvhh['CC5213c']*dvhh['weighta']
    useful_data['12.4.2'] = (dvhh['B229']+dvhh['CC5311c'])*dvhh['weighta']
    useful_data['12.4.3.1'] = (dvhh['B188']+dvhh['CC5411c'])*dvhh['weighta']
    useful_data['12.4.3.2'] = dvhh['CC5412t']*dvhh['weighta']
    useful_data['12.4.4'] = dvhh['CC5413t']*dvhh['weighta']
    useful_data['12.5.1.1'] = dvhh['B273']*dvhh['weighta']
    useful_data['12.5.1.2'] = dvhh['B280']*dvhh['weighta']
    useful_data['12.5.1.3'] = dvhh['B281']*dvhh['weighta']
    useful_data['12.5.1.4'] = dvhh['B282']*dvhh['weighta']
    useful_data['12.5.1.5'] = dvhh['B283']*dvhh['weighta']
    useful_data['12.5.2.1'] = (dvhh['B1802']+dvhh['CC6211c'])*dvhh['weighta']
    useful_data['12.5.2.2'] = dvhh['B238']*dvhh['weighta']
    useful_data['12.5.2.3'] = dvhh['CC6214t']*dvhh['weighta']
    useful_data['12.5.3.1'] = dvhh['CC7115t']*dvhh['weighta']
    useful_data['12.5.3.2'] = (dvhh['CC7111t']+dvhh['CC7112t'])*dvhh['weighta']
    useful_data['12.5.3.3'] = dvhh['CC7114t']*dvhh['weighta']
    useful_data['12.5.3.4'] = dvhh['CC7116t']*dvhh['weighta']
    useful_data['12.5.3.5'] = dvhh['CC7113t']*dvhh['weighta']
    useful_data['13.1.1'] = (dvhh['B130']+dvhh['B150'])*dvhh['weighta']
    useful_data['13.1.2'] = dvhh['B2081']*dvhh['weighta']
    useful_data['13.1.3'] = (dvhh['B030']+dvhh['B038p'])*dvhh['weighta']
    useful_data['13.2.1'] = dvhh['CK3111t']*dvhh['weighta']
    useful_data['13.2.2'] = dvhh['CK3112t']*dvhh['weighta']
    useful_data['13.2.2'] = (dvhh['B187']-dvhh['B179'])*dvhh['weighta']
    useful_data['13.3.1'] = dvhh['CK4111t']*dvhh['weighta']
    useful_data['13.3.2'] = dvhh['CK4112t']*dvhh['weighta']
    useful_data['13.4.1.1'] = (dvhh['CK5212t']+dvhh['CK5213t']+dvhh['CK5214t']+dvhh['CK5215t'])*dvhh['weighta']
    useful_data['13.4.1.2'] = dvhh['CK5216t']*dvhh['weighta']
    useful_data['13.4.2.1'] = (dvhh['CK5221t']+dvhh['CK5222t'])*dvhh['weighta']
    useful_data['13.4.2.2'] = dvhh['CK5223t']*dvhh['weighta']
    useful_data['13.4.2.3'] = (dvhh['B334h']+dvhh['CK5224c'])*dvhh['weighta']
    useful_data['13.4.2.4'] = dvhh['B265']*dvhh['weighta']
    useful_data['13.4.3.1'] = dvhh['CK5315c']*dvhh['weighta']
    useful_data['13.4.3.2'] = dvhh['B237']*dvhh['weighta']
    useful_data['14.1.1'] = (dvhh['B1961']+dvhh['B2011']+dvhh['CC5111c'])*dvhh['weighta']
    useful_data['14.1.2'] = (dvhh['P071h']+dvhh['CK5116t'])*dvhh['weighta']
    useful_data['14.1.3'] = dvhh['B228']*dvhh['weighta']
    useful_data['14.2'] = (dvhh['B206']+dvhh['CC5511c']+dvhh['B205']+dvhh['CC5312c'])*dvhh['weighta']
    useful_data['14.3.1'] = dvhh['p390p']*dvhh['weighta']
    useful_data['14.3.2'] = (dvhh['B387hp']+dvhh['CK5411c'])*dvhh['weighta']
    useful_data['14.3.3'] = dvhh['B391hp']*dvhh['weighta']
    useful_data['14.3.4'] = dvhh['P068h']*dvhh['weighta']
    useful_data['14.3.5'] = dvhh['P073hp']*dvhh['weighta']
    useful_data['14.3.6'] = dvhh['P391']*-1*dvhh['weighta']
    useful_data['14.3.7'] = dvhh['B390h']*-1*dvhh['weighta']
    useful_data['14.4.1'] = (dvhh['P388p']+dvhh['CK5412c'])*dvhh['weighta']
    useful_data['14.4.2'] = dvhh['P029hp']*dvhh['weighta']
    useful_data['14.5.1'] = dvhh['CK1211t']*dvhh['weighta']
    useful_data['14.5.2'] = (dvhh['B200']+dvhh['B203']+dvhh['B204']-dvhh['B250'])*dvhh['weighta']
    useful_data['14.5.3'] = (dvhh['B101']+dvhh['B103'])*dvhh['weighta']
    useful_data['14.5.4'] = dvhh['CK1314t']*dvhh['weighta']
    useful_data['14.5.5'] = dvhh['B105']*dvhh['weighta']
    useful_data['14.5.6'] = dvhh['CK1316t']*dvhh['weighta']
    useful_data['14.5.7'] = dvhh['CK1315t']*dvhh['weighta']
    useful_data['14.5.8'] = dvhh['CK1411t']*dvhh['weighta']
    useful_data['14.6.1'] = dvhh['CK5111t']*dvhh['weighta']
    useful_data['14.6.2'] = dvhh['CK5113t']*dvhh['weighta']
    useful_data['14.6.3'] = dvhh['CK2111t']*dvhh['weighta']
    useful_data['14.7'] = dvhh['CK5316t']*dvhh['weighta']
    useful_data['14.8'] = (dvhh['C9431At']+dvhh['C9431Bt']+dvhh['C9431Ct']+dvhh['C9431Dt']+dvhh['C9431Et']+dvhh['C9431Ft']+dvhh['C9431It'])*dvhh['weighta']

    
    return useful_data